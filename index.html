<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>åä¸œç ‚ç ‚èˆå… Â· æ¢ç´¢ç‰ˆ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC",
                   "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
      background: radial-gradient(circle at top, #302b63, #0f0c29);
      color: #f5f5f5;
    }
    .game {
      max-width: 720px;
      margin: 0 auto;
      min-height: 100vh;
      padding: 10px 10px 18px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .title {
      text-align: center;
      font-size: 1.4rem;
      font-weight: 700;
      padding: 4px 0;
      text-shadow: 0 0 10px rgba(0,0,0,0.8);
    }
    .card {
      background: rgba(0,0,0,0.40);
      border-radius: 14px;
      padding: 8px 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.55);
      backdrop-filter: blur(10px);
    }
    .top-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      justify-content: space-between;
      align-items: center;
    }
    .small-btn {
      border: none;
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 0.8rem;
      background: rgba(255,255,255,0.10);
      color: #f5f5f5;
      cursor: pointer;
      white-space: nowrap;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .small-btn:active {
      transform: translateY(1px);
      filter: brightness(0.95);
    }

    /* èˆå… 2.5D èˆå° */
    .stage-card {
      padding-bottom: 10px;
    }
    .stage-title {
      font-size: 0.86rem;
      margin-bottom: 4px;
      opacity: 0.9;
    }
    .stage {
      position: relative;
      height: 180px;
      border-radius: 14px;
      overflow: hidden;
      background: radial-gradient(circle at top, #ff9966, #660066);
      box-shadow: 0 10px 35px rgba(0,0,0,0.75);
      display: flex;
      align-items: center;
      justify-content: center;
      perspective: 800px;
    }
    .stage-wall {
      position: absolute;
      top: 0;
      left: -10%;
      right: -10%;
      height: 55%;
      background: radial-gradient(circle at 20% 0%, rgba(255,255,255,0.16), transparent 50%),
                  radial-gradient(circle at 80% 0%, rgba(255,255,255,0.18), transparent 55%),
                  linear-gradient(180deg, #2a1035, #130515 70%, #130515);
      box-shadow: inset 0 -12px 25px rgba(0,0,0,0.8);
      z-index: 1;
    }
    .stage-columns {
      position: absolute;
      top: 10px;
      left: 5%;
      right: 5%;
      height: 80%;
      display: flex;
      justify-content: space-between;
      pointer-events: none;
      z-index: 1;
    }
    .stage-column {
      width: 20px;
      border-radius: 999px;
      background: linear-gradient(180deg, rgba(255,255,255,0.16), rgba(0,0,0,0.85));
      box-shadow: 0 0 16px rgba(0,0,0,0.6);
      opacity: 0.65;
    }
    .stage-floor {
      position: absolute;
      bottom: -40px;
      left: -10%;
      right: -10%;
      height: 65%;
      background-image:
        linear-gradient(135deg, rgba(255,255,255,0.08) 25%, transparent 25%,
                        transparent 50%, rgba(255,255,255,0.08) 50%,
                        rgba(255,255,255,0.08) 75%, transparent 75%, transparent);
      background-size: 32px 32px;
      transform-origin: center top;
      transform: rotateX(65deg);
      box-shadow: 0 -10px 25px rgba(0,0,0,0.9);
      opacity: 0.95;
    }
    .stage-light-cone {
      position: absolute;
      top: -20px;
      left: 10%;
      right: 10%;
      height: 120%;
      background:
        radial-gradient(circle at 20% 0%, rgba(255, 255, 200, 0.40), transparent 60%),
        radial-gradient(circle at 80% 0%, rgba(200, 200, 255, 0.36), transparent 60%),
        radial-gradient(circle at 50% 20%, rgba(255, 170, 255, 0.28), transparent 55%);
      mix-blend-mode: screen;
      opacity: 0.95;
      pointer-events: none;
    }
    .stage-avatars {
      position: absolute;
      bottom: 35px;
      display: flex;
      gap: 32px;
      z-index: 3;
    }
    .avatar {
      width: 76px;
      height: 128px;
      border-radius: 50px 50px 30px 30px;
      background: linear-gradient(180deg, #ffd1a9, #ff7f7f);
      box-shadow: 0 0 16px rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: flex-start;
      flex-direction: column;
      transform: translateY(0);
      transition: transform 0.2s ease-out;
    }
    .avatar-head {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #ffe0c2;
      position: relative;
      box-shadow: 0 2px 4px rgba(0,0,0,0.5);
      margin-top: 6px;
    }
    .avatar-face-line {
      position: absolute;
      bottom: 10px;
      left: 9px;
      right: 9px;
      height: 7px;
      border-radius: 10px;
      border-bottom: 2px solid rgba(0,0,0,0.4);
    }
    .avatar-body {
      margin-top: 6px;
      width: 54px;
      height: 54px;
      border-radius: 24px;
      background: rgba(0,0,0,0.38);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.28rem;
    }
    .avatar-label {
      margin-top: 3px;
      font-size: 0.72rem;
      text-align: center;
      max-width: 90px;
      line-height: 1.3;
      text-shadow: 0 0 4px rgba(0,0,0,0.7);
    }
    .avatar-right {
      background: linear-gradient(180deg, #ff99d6, #ff4b8b);
    }
    .avatar-bob {
      animation: avatarBob 2.4s ease-in-out infinite;
    }
    @keyframes avatarBob {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-4px); }
      100% { transform: translateY(0px); }
    }

    .badge {
      display: inline-block;
      font-size: 0.72rem;
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(255,255,255,0.08);
      margin-right: 4px;
      margin-bottom: 4px;
      white-space: nowrap;
    }

    .stats-container {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.82rem;
    }
    .stat-row {
      display: grid;
      grid-template-columns: 80px 1fr 52px;
      align-items: center;
      gap: 4px;
    }
    .stat-label {
      opacity: 0.9;
      white-space: nowrap;
    }
    .stat-bar {
      height: 8px;
      border-radius: 999px;
      background: rgba(255,255,255,0.09);
      overflow: hidden;
    }
    .stat-bar-fill {
      height: 100%;
      border-radius: 999px;
      width: 0%;
      transition: width 0.2s ease-out;
    }
    .stat-value {
      text-align: right;
      opacity: 0.9;
      font-variant-numeric: tabular-nums;
    }

    .scene-title {
      font-size: 1.0rem;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .scene-text {
      font-size: 0.92rem;
      line-height: 1.65;
      white-space: pre-line;
    }
    .warning {
      margin-top: 6px;
      font-size: 0.82rem;
      color: #ffcc66;
      white-space: pre-line;
    }

    .choices {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 9px;
    }
    button.choice {
      border: none;
      border-radius: 999px;
      padding: 8px 11px;
      font-size: 0.9rem;
      text-align: left;
      background: linear-gradient(135deg, #ff5f6d, #ffc371);
      color: #1b0f0f;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
      transition: transform 0.08s ease, box-shadow 0.08s ease, filter 0.08s ease;
    }
    button.choice.secondary {
      background: rgba(255,255,255,0.09);
      color: #f5f5f5;
      box-shadow: none;
    }
    button.choice:active {
      transform: translateY(2px) scale(0.99);
      box-shadow: 0 1px 4px rgba(0,0,0,0.5);
      filter: brightness(0.96);
    }

    .move-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 4px;
      margin-top: 8px;
    }
    .move-grid button {
      font-size: 0.78rem;
    }

    .log {
      font-size: 0.78rem;
      max-height: 140px;
      overflow-y: auto;
      padding-right: 4px;
      color: #c3c3d6;
    }
    .log-line {
      margin-bottom: 3px;
      opacity: 0.86;
    }
    .footer {
      margin-top: 2px;
      text-align: center;
      font-size: 0.76rem;
      color: #9294b8;
    }

    @media (max-width: 520px) {
      .game { padding: 8px 6px 14px; }
      .title { font-size: 1.22rem; }
      .scene-text { font-size: 0.9rem; }
      button.choice { font-size: 0.86rem; }
      .stat-row { grid-template-columns: 70px 1fr 44px; }
      .stage { height: 170px; }
    }
  </style>
</head>
<body>
<div class="game">
  <div class="title">åä¸œç ‚ç ‚èˆå…</div>

  <div class="card top-bar">
    <div style="font-size:0.8rem; opacity:0.9;">
      èƒŒæ™¯ï¼šæ±Ÿæµ™æ²ªç ‚ç ‚èˆå…
    </div>
    <div style="display:flex; gap:6px; flex-wrap:wrap;">
      <button class="small-btn" onclick="toggleBgm(this)">ğŸµ èƒŒæ™¯éŸ³ä¹</button>
      <button class="small-btn" onclick="saveGame()">ğŸ’¾ å­˜æ¡£</button>
      <button class="small-btn" onclick="loadGame()">ğŸ“‚ è¯»æ¡£</button>
      <button class="small-btn" onclick="restartGame()">ğŸ” é‡å¼€ä¸€æ™š</button>
    </div>
  </div>

  <div class="card stage-card">
    <div class="stage-title" id="stageAreaLabel">åŒºåŸŸï¼šèˆå…å¤– Â· è€è¡—å…¥å£</div>
    <div class="stage" id="stage">
      <div class="stage-wall"></div>
      <div class="stage-columns">
        <div class="stage-column"></div>
        <div class="stage-column"></div>
        <div class="stage-column"></div>
      </div>
      <div class="stage-light-cone"></div>
      <div class="stage-floor"></div>

      <div class="stage-avatars">
        <div class="avatar avatar-bob" id="avatarPlayer">
          <div class="avatar-head">
            <div class="avatar-face-line"></div>
          </div>
          <div class="avatar-body" id="avatarBodyEmoji">ğŸ•º</div>
          <div class="avatar-label" id="avatarLabel">æœªé€‰æ‹©</div>
        </div>
        <div class="avatar avatar-right avatar-bob" id="avatarPartner">
          <div class="avatar-head">
            <div class="avatar-face-line"></div>
          </div>
          <div class="avatar-body" id="avatarPartnerEmoji">ğŸ’ƒ</div>
          <div class="avatar-label" id="avatarPartnerLabel">èˆä¼´</div>
        </div>
      </div>
    </div>
  </div>

  <div class="card" id="roleCard">
    <div style="font-size:0.9rem; margin-bottom:4px;"><strong>è§’è‰²å¡</strong></div>
    <div id="roleCardBody" style="font-size:0.82rem; line-height:1.5;">
      <em>å…ˆé€‰æ‹©ä¸€ä¸ªè§’è‰²ï¼Œå†³å®šä»Šæ™šä»¥è°çš„èº«ä»½åœ¨åä¸œç ‚ç ‚èˆå…è‡ªç”±æ¸¸èµ°ã€‚</em>
    </div>
    <div id="roleTraits" style="margin-top:6px;"></div>
  </div>

  <div class="card">
    <div style="font-size:0.86rem; margin-bottom:4px;">ğŸ¯ å½“å‰å±æ€§</div>
    <div class="stats-container">
      <div class="stat-row">
        <div class="stat-label">ğŸ’° ç°é‡‘</div>
        <div class="stat-bar"><div class="stat-bar-fill" id="barCash"></div></div>
        <div class="stat-value" id="statCash">0</div>
      </div>
      <div class="stat-row">
        <div class="stat-label">â¤ï¸ ä½“åŠ›</div>
        <div class="stat-bar"><div class="stat-bar-fill" id="barStamina"></div></div>
        <div class="stat-value" id="statStamina">0</div>
      </div>
      <div class="stat-row">
        <div class="stat-label">âš¡ è‡ªä¿¡</div>
        <div class="stat-bar"><div class="stat-bar-fill" id="barConfidence"></div></div>
        <div class="stat-value" id="statConfidence">0</div>
      </div>
      <div class="stat-row">
        <div class="stat-label">ğŸ’ƒ èˆæŠ€</div>
        <div class="stat-bar"><div class="stat-bar-fill" id="barDance"></div></div>
        <div class="stat-value" id="statDance">0</div>
      </div>
      <div class="stat-row">
        <div class="stat-label">ğŸ‘ è§‚å¯ŸåŠ›</div>
        <div class="stat-bar"><div class="stat-bar-fill" id="barAwareness"></div></div>
        <div class="stat-value" id="statAwareness">0</div>
      </div>
      <div class="stat-row">
        <div class="stat-label">ğŸ§  æŠ—PUA</div>
        <div class="stat-bar"><div class="stat-bar-fill" id="barAntiPua"></div></div>
        <div class="stat-value" id="statAntiPua">0</div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="scene-title" id="sceneTitle"></div>
    <div class="scene-text" id="sceneText"></div>
    <div class="warning" id="sceneWarning" style="display:none;"></div>

    <div class="choices" id="choices"></div>

    <div class="move-grid" id="moveGrid">
      <button class="small-btn" onclick="moveArea('up')">â¬† å‘å‰</button>
      <button class="small-btn" onclick="moveArea('info')">ğŸ“˜ èˆå…åœ°å›¾</button>
      <button class="small-btn" onclick="moveArea('down')">â¬‡ å‘å</button>
      <button class="small-btn" onclick="moveArea('left')">â¬… å‘å·¦</button>
      <button class="small-btn" onclick="moveArea('stay')">ğŸ§ åŸåœ°è§‚å¯Ÿ</button>
      <button class="small-btn" onclick="moveArea('right')">â¡ å‘å³</button>
    </div>
  </div>

  <div class="card">
    <div style="font-size:0.82rem; margin-bottom:4px;">ğŸ“œ è¡Œä¸ºè®°å½•</div>
    <div class="log" id="logBox"></div>
  </div>

  <div class="footer">
    æœ¬æ¸¸æˆä¸ºè™šæ„å‰§æƒ…ï¼Œä»…åšå¨±ä¹ä¸é˜²PUAç§‘æ™®ï¼šç ‚ç ‚èˆåªæå†™æš§æ˜§æ‹¥æŠ±ï¼Œä¸æ¶‰åŠä»»ä½•è¿æ³•æˆ–è¿‡ç•Œå†…å®¹ã€‚è¯·ç†æ€§æ¶ˆè´¹ï¼Œè¿œç¦»â€œæå¥³â€å’Œä»»ä½•ç»æµã€æƒ…æ„Ÿéª—å±€ã€‚
  </div>
</div>

<!-- éŸ³é¢‘ï¼šè¯·å°† src æ¢æˆä½ è‡ªå·±çš„ mp3 -->
<audio id="bgm" loop>
  <!-- <source src="your_bgm.mp3" type="audio/mpeg"> -->
</audio>
<audio id="sfxClick">
  <!-- <source src="click.mp3" type="audio/mpeg"> -->
</audio>

<script>
  // ===== è§’è‰²è®¾å®š =====
  const roles = {
    factory: {
      id: "factory",
      name: "å·¥å‚æ‰“å·¥çš„å¹´è½»äºº",
      alias: "æ‰“å·¥ä»”",
      emoji: "ğŸ§‘â€ğŸ­",
      color: "#ffb347",
      desc: "è‹å·å·¥ä¸šå›­åŒºç”µå­å‚æµæ°´çº¿å·¥äººï¼Œç¬¬ä¸€æ¬¡èµ°è¿›è¿™ç§æŠ±æŠ±èˆçš„ç ‚èˆå…ã€‚",
      equip: "æ‹¼å¤šå¤š 99 å…ƒç™½è¡¬è¡«ã€æ·±è‰²è¥¿è£¤ã€æ“¦å¾—é”ƒäº®çš„æ—§çš®é‹ï¼Œèº«ä¸Šå¸¦ç€ä¸€ç‚¹é¦™çš‚å‘³ã€‚",
      traits: ["é‡æ€§ç›´è§‰", "è‡ªå‘ä¸æ¸´æœ›", "å¿«é€Ÿæ¨¡ä»¿"],
      stats: { cash: 200, stamina: 100, confidence: 10, dance: 0, awareness: 20, antiPua: 5 }
    },
    oldman: {
      id: "oldman",
      name: "é€€ä¼‘è€å¤´",
      alias: "è€å…ˆç”Ÿ",
      emoji: "ğŸ§“",
      color: "#f4d35e",
      desc: "è‹å·æœ¬åœ°é€€ä¼‘è€äººï¼Œç©¿ç€æ—§è¥¿è£…ï¼Œèˆæ­¥è€æ´¾å´èŠ‚å¥æ„Ÿæä½³ã€‚",
      equip: "å¤å¤è¥¿è£…ã€çš®é‹æ“¦å¾—é”ƒäº®ï¼Œå¤´å‘ç”¨å‘èœ¡ä¸€ä¸ä¸è‹Ÿã€‚",
      traits: ["æ·±è—ä¸éœ²", "é•¿è¾ˆå…‰ç¯"],
      stats: { cash: 400, stamina: 70, confidence: 40, dance: 40, awareness: 40, antiPua: 30 }
    },
    unemployed: {
      id: "unemployed",
      name: "å¤±ä¸šçš„ä¸­å¹´äºº",
      alias: "ä¸­å¹´äºº",
      emoji: "ğŸ§‘â€ğŸ’¼",
      color: "#c06c84",
      desc: "åˆšæ‹¿åˆ°è£å‘˜è¡¥å¿é‡‘ï¼Œç™½å¤©åœ¨å’–å•¡é¦†è£…ä½œä¸Šç­ï¼Œæ™šä¸Šæ¥æŠ±æŠ±èˆå…æ‰¾â€œæˆ‘è¿˜æ´»ç€â€çš„æ„Ÿè§‰ã€‚",
      equip: "ä¼‘é—²è¥¿è£…å¤–å¥—ã€æœ‰ç‚¹çš±çš„è¡¬è¡«ï¼Œçœ¼ç¥ç•¥æ˜¾ç–²æƒ«ã€‚",
      traits: ["æƒ…æ„Ÿå…±é¸£", "é¢“åºŸæ°”è´¨"],
      stats: { cash: 600, stamina: 80, confidence: 30, dance: 10, awareness: 35, antiPua: 20 }
    },
    richkid: {
      id: "richkid",
      name: "å¯ŒäºŒä»£",
      alias: "å°‘çˆ·",
      emoji: "ğŸ§‘â€ğŸ•º",
      color: "#ff6b6b",
      desc: "å¼€ç€è·‘è½¦åœåœ¨è€è¡—å£ï¼Œåªæ˜¯æŠŠç ‚èˆå…å½“ä½œæ–°çš„çŒå¥‡æ¶ˆé£ã€‚",
      equip: "æ½®ç‰ŒTæ¤ã€åç‰Œè¿åŠ¨é‹ï¼Œæ‰‹è…•ä¸Šæˆ´ç€é—ªé—ªçš„è¡¨ã€‚",
      traits: ["é‡‘é’±å…‰ç¯", "è‡ªä¿¡çˆ†æ£š"],
      stats: { cash: 2000, stamina: 90, confidence: 80, dance: 20, awareness: 20, antiPua: 10 }
    },
    landlord: {
      id: "landlord",
      name: "æ‹†è¿æˆ· Â· æœ¬åœ°åœ°ä¸»",
      alias: "è€æ¿",
      emoji: "ğŸ§”",
      color: "#f7b733",
      desc: "å®¶é‡Œæ‹†äº†å‡ å¥—æˆ¿ï¼Œè§‰å¾—æ¥å­¦æŠ±æŠ±èˆæ˜¯ä¸€ç§â€œé«˜é›…ç”Ÿæ´»â€ã€‚",
      equip: "Polo è¡«æ‰è¿›çš®å¸¦ï¼Œé‡‘é“¾å­åœ¨ç¯å…‰ä¸‹æ™ƒçœ¼ã€‚",
      traits: ["æœ¬åœ°éœ¸æ°”", "è±ªçˆ½ä¹°å•"],
      stats: { cash: 1500, stamina: 85, confidence: 60, dance: 5, awareness: 20, antiPua: 15 }
    },
    itguy: {
      id: "itguy",
      name: "ITç”· Â· ç¨‹åºå‘˜",
      alias: "ç¨‹åºå‘˜",
      emoji: "ğŸ‘¨â€ğŸ’»",
      color: "#4ecdc4",
      desc: "æ ¼å­è¡«ã€é»‘æ¡†çœ¼é•œï¼ŒæŠŠæŠ±æŠ±èˆçš„æ­¥ä¼å½“â€œ0å’Œ1â€çš„ä»£ç æ¥è®°ã€‚",
      equip: "æ ¼å­è¡«ã€ç‰›ä»”è£¤ã€è¿åŠ¨é‹ï¼Œè‚©ä¸ŠèƒŒç€ç”µè„‘åŒ…è¿˜æ²¡æ”¾ä¸‹ã€‚",
      traits: ["æœºæ¢°ç²¾å‡†", "æå®¢é­…åŠ›"],
      stats: { cash: 500, stamina: 60, confidence: 15, dance: 0, awareness: 30, antiPua: 25 }
    }
  };

  const MAX_CASH_BAR = 2000;

  // åŒºåŸŸä¸»é¢˜ï¼šæ”¹å˜èˆå°é¢œè‰²
  const areaThemes = {
    "entrance": { label: "èˆå…å¤– Â· è€è¡—å…¥å£", bg: "radial-gradient(circle at top, #ff9966, #2d0030)" },
    "lobby": { label: "å‰å°å¤§å… Â· å”®ç¥¨å¤„", bg: "radial-gradient(circle at top, #ffb347, #3b1f4a)" },
    "dancefloor": { label: "èˆæ± ä¸­å¤® Â· æŠ±æŠ±èˆä¸»æˆ˜åœº", bg: "radial-gradient(circle at top, #ff6b81, #220019)" },
    "girlline": { label: "èˆå¥³é˜Ÿåˆ— Â· ç¯å…‰æœ€äº®å¤„", bg: "radial-gradient(circle at top, #ffc371, #2e1544)" },
    "bar": { label: "å§å° Â· ä¸è·³èˆçš„åœ°æ–¹", bg: "radial-gradient(circle at top, #ff9a9e, #1b2a49)" },
    "seats": { label: "å¡åº§åŒº Â· èŠå¤©ä¸æœºè½¦èšé›†åœ°", bg: "radial-gradient(circle at top, #f6d365, #42378f)" },
    "smoking": { label: "å¸çƒŸåŒº Â· è€èˆå®¢å…«å¦ç‚¹", bg: "radial-gradient(circle at top, #a1c4fd, #1c1f2a)" },
    "corridor": { label: "èµ°å»Š/å•æ‰€å£ Â· å°é“æ¶ˆæ¯å¤š", bg: "radial-gradient(circle at top, #d4fc79, #284058)" }
  };

  const gameState = {
    roleId: null,
    cash: 0,
    stamina: 0,
    confidence: 0,
    dance: 0,
    awareness: 0,
    antiPua: 0,
    sceneId: "roleSelect",
    areaKey: "entrance",
    flags: {},
    enteredScenes: {}
  };

  // ===== åœºæ™¯ï¼ˆå¼€æ”¾æ²™ç›’ + ä¿¡æ¯ + æŠ±æŠ±èˆå‰§æƒ…ï¼‰ =====

  const text_newbie10 = `
ç ‚èˆ 10 ç‚¹æ³¨æ„äº‹é¡¹ï¼ˆæ–°äººå¿…è¯»ï¼‰ï¼š

1ï¸âƒ£ è¡£ç€æ•´æ´å¹²å‡€ï¼Œæœ‰åŠ©äºæé«˜èˆå¥³å¥½æ„Ÿåº¦ã€‚ä¸å®œç©¿è¥¿è£…å’Œå·¥ä½œæœï¼Œä¸è¦è¡Œä¸ºé«˜è°ƒï¼Œèˆå…é‡Œäººå‘˜ç´ è´¨å‚å·®ä¸é½ï¼Œé¿å…å¼•æ¥ä¸å¿…è¦çš„éº»çƒ¦ã€‚

2ï¸âƒ£ å¤§éƒ¨åˆ†èˆå…ç¦æ­¢å¸çƒŸï¼Œè¦å¸çƒŸè¯·å»å¸çƒŸå®¤ã€‚

3ï¸âƒ£ é¢œå€¼é«˜ã€æ°”è´¨å¥½çš„æœºè½¦èˆå¥³ï¼Œå¤šæ•°æœ‰å›ºå®šé‡‘ä¸»ã€‚å¦‚æœç»æµå®åŠ›ä¸€èˆ¬ï¼Œåˆ«æ·±é™·å…¶ä¸­ã€‚

4ï¸âƒ£ é¿å…å’Œèˆå…å·¥ä½œäººå‘˜äº‰æ‰§ï¼Œå‹å¥½ç›¸å¤„ï¼Œä¿æŒæ„‰æ‚¦å¿ƒæƒ…ç©è€ã€‚

5ï¸âƒ£ å¤šå®ˆåœ¨èˆæ± è¾¹ç¼˜ï¼Œç»å¸¸åœ¨èˆå…è½¬æ‚ ï¼Œå¤šçœ‹å°‘è·³ï¼Œäº‰å–ç¬¬ä¸€æ—¶é—´æŠ¢åˆ°â€œå¥½è´§â€ã€‚

6ï¸âƒ£ ä¸è¦å¸¦è¿½æ±‚è€…å¿ƒæ€é¢‘ç¹å¾®ä¿¡å˜˜å¯’é—®æš–ï¼Œå¥¹ä»¬å¾ˆå¤šç”¨å·¥ä½œå·/å°å·åŠ äººï¼Œä½ çš„æ®·å‹¤å¯èƒ½è¢«å½“æˆéªšæ‰°ã€‚

7ï¸âƒ£ ä¸è¦å®³ç¾å’Œèˆå¥³è°ˆä»·æ ¼ï¼Œè¦å­¦ä¼šç ä»·ã€‚

8ï¸âƒ£ ç©èˆå…ï¼Œâ€œåŠˆæƒ…æ“â€çš„æ¯”â€œç©å°ºåº¦â€çš„å¾€å¾€èŠ±æ›´å¤šé’±ï¼Œåˆ‡è®°ä¸è¦å¯¹èˆå¥³åŠ¨æƒ…ã€‚

9ï¸âƒ£ ä¸è¦é¢‘ç¹å»èˆå…ï¼Œæ§åˆ¶æ¶ˆè´¹ï¼Œè®©è‡ªå·±é™¤äº†èˆå…è¿˜æœ‰å…¶ä»–å…´è¶£çˆ±å¥½ã€‚

ğŸ”Ÿ å­¦ä¼šæ‹’ç»ï¼Œä¸è¦ä¸ºé¢å­æŸè´¢åšåƒåŠ›ä¸è®¨å¥½çš„äº‹ã€‚è¯·èˆå¥³åƒé¥­ã€ä¹°é—¨ç¥¨ã€æ‰“è½¦é€å›å®¶â€¦å¥¹ä»¬ä¸‹ä¸€ç§’å°±ä¼šå¿˜ï¼Œå®Œå…¨æ˜¯ç™½è´¹åŠŸå¤«ã€‚
`;

  const text_history = `
èˆå…å†å² Â· æ–°äººåŸºç¡€ç¯‡ï¼ˆèŠ‚é€‰ï¼‰

è¿‘ä»£æ‘¸æ‘¸èˆå…æœ€æ—©èµ·æºäºæˆéƒ½ï¼Œå«â€œç ‚èˆâ€ï¼›å…°å·å«â€œæ‘¸å§â€ï¼›ä¸œåŒ—å«â€œé»‘ä¸‰æ›²â€ï¼›ä¸œå—äºšè¶Šå—å« OMï¼ˆä¸­å›½å¼æŠ±ï¼‰ã€‚

è¿™äº›æ¨¡å¼éƒ½ç±»ä¼¼è§£æ”¾å‰ä¸Šæµ·ç™¾ä¹é—¨çš„å¥³å­é™ªèˆâ€”â€”ä¸¥æ ¼æ¥è¯´ï¼Œåé‡Œæ´‹åœºçš„ä¸Šæµ·ï¼Œæ‰æ˜¯è¿‘ä»£èˆå…çš„é¼»ç¥–ã€‚

90 å¹´ä»£æœ«åˆ° 21 ä¸–çºªåˆè¾¾åˆ°é¼ç››ï¼š
å—åˆ°æ˜†æ˜ï¼ŒåŒ—åˆ°é•¿æ˜¥ï¼Œä¸œåˆ°ä¸Šæµ·ï¼Œè¥¿åˆ°å…°å·ï¼Œå…¨å›½å‡ ä¹æ‰€æœ‰çœä¼šåŸå¸‚éƒ½æœ‰èˆå…ã€‚

è‘—åçš„å¦‚ï¼š
æˆéƒ½çº¢çº¢ã€è‹å·è“å ¡ã€å¤§è¿ç³ç³ã€è¥¿å®‰ç«å‡¤å‡°ã€é‡åº†é‡‘ä¹é—¨ã€é•¿æ˜¥å¤©å®‡ç¿”â€¦â€¦
`;

  const text_machineGuide = `
åä¸œèˆå… Â· é˜²æœºè½¦åŸºç¡€æŒ‡å—ï¼ˆèŠ‚é€‰ï¼‰

1ï¸âƒ£ è¡£ç€æœºè½¦å‹ï¼š
é«˜é¢†ã€æ— æ‰£ã€é•¿è¢–ï¼Œè¿˜çˆ±ç©¿ç‰›ä»”è£¤æˆ–è¿ä½“é•¿è£¤ï¼Œæ“ä½œç©ºé—´å¾ˆå°ã€‚è¿™ç±»èˆå¥³é è„¸è›‹å¸å¼•æ–°æ‰‹ï¼Œå®¹æ˜“åƒé—·äºã€‚

2ï¸âƒ£ å±è¯å¤šã€æŠ±æ€¨å¤šï¼š
å«Œä½ æ‰‹æ±—ã€å«Œä½ æ‰‹å¤ªå‡‰ã€å«Œåœ°æ¿è„ï¼Œåªæ„¿åœ¨èˆæ± å¤–å›´è·³ï¼Œä¸æ„¿æ·±å…¥èˆæ± ï¼Œå¤šåŠæ˜¯æœºè½¦ä¿¡å·ã€‚

3ï¸âƒ£ ä¸‰äº”æˆç¾¤æ‰å †èŠå¤©ï¼š
æœºè½¦èˆå¥³å› ä¸ºç”Ÿæ„å·®ï¼Œç»å¸¸è¢«æ”¾ç”Ÿï¼Œåªå¥½äº’ç›¸å–æš–èŠå¤©ã€‚é‚£ä¸€ç‰‡åŒºåŸŸï¼Œé€šå¸¸æ˜¯ä¸€æ›²æ”¾ç”Ÿçš„æœºè½¦èšé›†åœ°ã€‚

4ï¸âƒ£ ä¸€æ›²æœªå®Œå°±æ”¾ç”Ÿï¼š
ç»å¸¸ä¸€é¦–æ­Œæ²¡ç»“æŸå°±ä¸‹åœºï¼Œè¿˜æ—¶å¸¸å’Œå®¢äººåœ¨èˆæ± åµæ¶ï¼ˆä¸è®©æ‘¸ã€ä¹±æŠ¥æ›²æ•°ï¼‰ï¼Œè¿™ç§åƒä¸‡é¿å¼€ã€‚
`;

  const text_avoidTraps = `
å¦‚ä½•é¿å…è¢«èˆå¥³å¥—è·¯ï¼Ÿï¼ˆç²¾ç®€ç‰ˆï¼‰

1ï¸âƒ£ è·³å®Œèˆä¸ç•™è”ç³»æ–¹å¼ï¼š
ä¸åŠ å¾®ä¿¡ï¼Œå°±ä¸ä¼šå¤©å¤©è¢«çº¢åŒ…å’Œä¿¡æ¯ç‰µç€èµ°ã€‚

2ï¸âƒ£ ä¸åå°ï¼š
æƒ³èŠå¤©ï¼Œèˆæ± é‡Œå°±èƒ½èŠï¼Œä¸å¿…é¢å¤–ä¹°æ—¶é—´ã€‚

3ï¸âƒ£ æ˜ç¡®è‡ªå·±çš„ç›®çš„ï¼š
æ‰“å‘æ—¶é—´ï¼Ÿç»ƒèˆï¼Ÿè¿˜æ˜¯è¦å‡ºå»ï¼Ÿå¦‚æœè¦å‡ºå»ï¼Œç¬¬ä¸€æ›²å°±ç›´æ¥é—®ï¼Œä¸åˆé€‚å°±æ¢äººï¼Œä¸è¦æš§æ˜§æ‹–å»¶ã€‚

4ï¸âƒ£ ä¸è¦é¢å¤–äº¤é’±ä¹°ç¤¼ç‰©ï¼š
æ­£å¸¸èˆè´¹å¯ä»¥ç»™ï¼Œä½†è¡£æœã€åŒ–å¦†å“ã€åŒ…åŒ…ã€ç¤¼ç‰©è®©å¥¹è‡ªå·±æé’±ã€‚ä¸€æ—¦å¼€å§‹ä¹°ç¤¼ç‰©ï¼Œå…³ç³»é©¬ä¸Šå˜å‘³ã€‚
`;

  const text_suwurenjian = `
ã€Šè‹èˆäººé—´ã€‹ï¼ˆèŠ‚é€‰ï¼‰

â€œæœ‰äººè¯´ï¼šå½“ä½ æƒ³åŠªåŠ›å¿˜è®°è¿‡å»ï¼Œå°±å»èˆå…ï¼Œåˆ«è·³åˆ°èº«æ— åˆ†æ–‡ï¼Œä¸¤æ›²å³å¯ï¼Œç„¶åï¼Œä½ ä¼šçœ‹è§èˆæ± é‡Œçš„ä½™ç”Ÿã€‚â€

åœ¨è¿™äº”å…‰åè‰²çš„äººå·¥ä½œåŠé‡Œï¼Œå…‰æ€ªé™†ç¦»çš„ç”Ÿæ´»ï¼Œæˆäº†å¿§æ„äººçš„è§£è„±ï¼š
æœ‰äººæ·±çˆ±ï¼Œä»–ä»¬è·³èˆï¼›
æœ‰äººæ— çˆ±ï¼Œä»–ä»¬è·³èˆï¼›
æœ‰äººå¤±çˆ±ï¼Œä»ç„¶è·³èˆã€‚

èˆæ± é‡Œçš„ä½™ç”Ÿï¼Œæ˜¯æ€æ ·çš„æ„Ÿå—ï¼Ÿ
ä¹Ÿè®¸ï¼Œåªæœ‰æ‚²ä¼¤äººæ‰æ‡‚ã€‚
`;

  const text_dragonGirl = `
é¾™å¥³å¿ƒé­” Â· ç®€è¦è¯´æ˜

èˆå…é‡Œçš„â€œé¾™å¥³â€ï¼ˆå°¤å…¶æ˜¯è‹å“‘èˆå¥³ï¼‰å¾€å¾€ï¼š
â€” èº«æä¿æŒå¾—å¾ˆå¥½ï¼›
â€” æˆ´å£ç½©ï¼Œçœ¼ç›æ¸…æ¾ˆï¼Œè¡¨æƒ…å¹²å‡€ï¼›
â€” æ— æ³•æ­£å¸¸è¯­è¨€æ²Ÿé€šã€‚

å¾ˆå¤šèˆå®¢ä¼šå¯¹è¿™ç±»èˆå¥³äº§ç”Ÿâ€œæ•‘ä¸–ä¸»æƒ…ç»“â€ï¼š
è§‰å¾—è‡ªå·±å¯ä»¥ç»™å¥¹ä¸€ä¸ªä¸ä¸€æ ·çš„äººç”Ÿï¼Œæˆ–è€…è§‰å¾—å¯¹æ–¹æ¯”å…¶ä»–äººâ€œæ›´çœŸå®â€ã€‚

å”¯ä¸€çš„å»ºè®®ï¼š
å¦‚æœå¯ä»¥ï¼Œä¸è¦åªæ‰¾é¾™å¥³è·³èˆï¼Œæ›´ä¸è¦è´¬ä½æ­£å¸¸èˆå¥³ã€å¹æ§é¾™å¥³ã€‚
ç¡®å®æƒ³ä½“éªŒé¾™å¥³çš„èˆï¼Œä¸è¦ç›¯ç€å¥¹çš„çœ¼ç›çœ‹å¤ªä¹…ï¼Œä¸€åˆ‡æ„Ÿæƒ…éƒ½æ˜¯ä½ è‡ªå·±è„‘è¡¥å‡ºæ¥çš„ã€‚
`;

  const scenes = {
    // è§’è‰²é€‰æ‹©
    roleSelect: {
      areaKey: "entrance",
      title: "é€‰æ‹©ä»Šæ™šçš„èº«ä»½ Â· åä¸œç ‚ç ‚èˆå…é—¨å£",
      text: `è€è¡—å°½å¤´ï¼Œä¸€å—å¹¶ä¸æ˜¾çœ¼çš„éœ“è™¹ç‰Œä¸Šå†™ç€ï¼š

ã€Œåä¸œç ‚ç ‚èˆå…ã€

è¿™æ˜¯ä¸€ä¸ªä»¥ç ‚èˆã€æŠ±æŠ±èˆä¸ºä¸»çš„åœºå­ï¼Œæ²¡æœ‰ DJ å°ï¼Œåªæœ‰éŸ³ç®±ã€ç¯çƒã€èˆå¥³å’Œèˆå®¢ã€‚

ä»Šæ™šï¼Œä½ è¦ä»¥è°çš„èº«ä»½èµ°è¿›å»ï¼Œåœ¨è¿™ä¸ªå°å°çš„ä¸–ç•Œé‡Œè‡ªç”±èµ°åŠ¨ã€è§‚å¯Ÿã€è·³èˆã€é¿å‘ï¼Ÿ`,
      options: [
        { text: "å·¥å‚æ‰“å·¥çš„å¹´è½»äººï¼ˆæ‹¼å¤šå¤š 99 å…ƒè¡¬è¡«ï¼‰", chooseRole: "factory", next: "entrance_intro", log: "ä½ æäº†æè‡ªå·±ç†¨å¾—ç¬”ç›´çš„ç™½è¡¬è¡«ï¼Œå†³å®šèµŒä¸€æŠŠã€‚"},
        { text: "é€€ä¼‘è€å¤´ï¼ˆå¤å¤è¥¿è£…ï¼Œè€æ´¾æ­¥å­ï¼‰", chooseRole: "oldman", next: "entrance_intro", log: "ä½ ç†äº†ç†è¢–å£ï¼Œå¸¦ç€è€æ´¾æ°”è´¨èµ°å‘ç¯å…‰ã€‚"},
        { text: "å¤±ä¸šçš„ä¸­å¹´äººï¼ˆè£å‘˜è¡¥å¿é‡‘åœ¨å…œé‡Œï¼‰", chooseRole: "unemployed", next: "entrance_intro", log: "ä½ æäº†æå£è¢‹é‡Œçš„è¡¥å¿é‡‘ï¼Œæƒ³ç¡®è®¤è‡ªå·±è¿˜æ´»ç€ã€‚"},
        { text: "å¯ŒäºŒä»£ï¼ˆè·‘è½¦åœåœ¨å··å£ï¼‰", chooseRole: "richkid", next: "entrance_intro", log: "ä½ é”å¥½è·‘è½¦ï¼Œå‡†å¤‡çœ‹çœ‹â€œå¹³æ°‘æŠ±æŠ±èˆå…â€æœ‰å¤šæ–°é²œã€‚"},
        { text: "æ‹†è¿æˆ· Â· æœ¬åœ°åœ°ä¸»ï¼ˆé‡‘é“¾å­æ™ƒçœ¼ï¼‰", chooseRole: "landlord", next: "entrance_intro", log: "ä½ æ™ƒäº†æ™ƒè„–å­ä¸Šçš„é‡‘é“¾ï¼Œå¿ƒæƒ³ï¼šä»Šæ™šåœºå­æˆ‘ç½©äº†ã€‚"},
        { text: "IT ç”· Â· ç¨‹åºå‘˜ï¼ˆè¢«åŒ»ç”Ÿé€¼å‡ºæ¥ç¤¾äº¤ï¼‰", chooseRole: "itguy", next: "entrance_intro", log: "ä½ åœ¨å¿ƒé‡Œé»˜å¿µï¼štonight = new SocialEvent();"}
      ]
    },

    entrance_intro: {
      areaKey: "entrance",
      title: "è€è¡—å…¥å£ Â· å¤œè‰²ä¸å‘¼å¸",
      text: `å¤œé£å¹è¿‡è‹å·è€è¡—ï¼Œè¿œå¤„ä¼ æ¥è¨å…‹æ–¯å’Œé¼“ç‚¹çš„æ··åˆå£°ã€‚

é—¨å£ä¸‰ä¸‰ä¸¤ä¸¤æœ‰äººåœ¨æŠ½çƒŸã€åˆ·æ‰‹æœºã€æ‰“è½¦ã€‚

ä¸ç®¡ä½ æ˜¯ {roleName}ï¼Œ
ä½ éƒ½çŸ¥é“ï¼šåªè¦è¿ˆè¿›é‚£æ‰‡é—¨ï¼Œä»Šæ™šçš„æƒ…ç»ªå°±è·Ÿç°å®åˆ‡å¼€äº†ä¸€åˆ€ã€‚`,
      options: [
        { text: "æ¨é—¨è¿›å»ï¼Œæ­£å¼è¿›å…¥èˆå…ï¼ˆ+5 è‡ªä¿¡ï¼‰", effects: { confidence: 5, awareness: 2 }, next: "lobby_front", log: "ä½ ä¼¸æ‰‹æ¨å¼€é—¨ï¼Œç¯å…‰ä»ç¼éš™é‡Œæ¶Œå‡ºæ¥ã€‚" },
        { text: "åœ¨é—¨å£å¤šè§‚å¯Ÿä¸€ä¼šï¼Œçœ‹çœ‹è¿›è¿›å‡ºå‡ºçš„æ˜¯ä»€ä¹ˆäººï¼ˆ+è§‚å¯Ÿï¼‰", effects: { awareness: 6 }, next: "entrance_watch", log: "ä½ é åœ¨å¢™è¾¹ï¼Œå‡è£…çœ‹æ‰‹æœºï¼Œæš—ä¸­è§‚å¯Ÿæ¥å¾€çš„å®¢äººã€‚" },
        { text: "çªç„¶æ€‚äº†ï¼Œä»Šæ™šä¸å»äº†ï¼ˆç›´æ¥ç»“æŸï¼‰", effects: { confidence: -3 }, next: "end_goHome", log: "ä½ è½¬èº«ç¦»å¼€ï¼ŒæŠŠè¿™ä»½å†²åŠ¨æš‚æ—¶æ”¶è¿›å¿ƒé‡Œã€‚" }
      ]
    },

    entrance_watch: {
      areaKey: "entrance",
      title: "é—¨å¤–è§‚å¯Ÿ Â· è°åœ¨è¿›è¿™ä¸ªä¸–ç•Œï¼Ÿ",
      text: `ä½ åœ¨é—¨å£çœ‹äº†åå‡ åˆ†é’Ÿï¼š

â€” æœ‰ç©¿å·¥è£…çš„æœ¬åœ°äººï¼Œè¡¨æƒ…å¾ˆå¹³é™ï¼Œå¥½åƒåœ¨ä¸‹ç­å»é£Ÿå ‚ã€‚
â€” æœ‰æ‰“æ‰®å…¥æ—¶çš„å°å§‘å¨˜ï¼Œå’Œå§å¦¹æŒ½ç€æ‰‹èµ°è¿›å»ã€‚
â€” æœ‰çœ‹ä¸Šå»å¾ˆä½“é¢çš„ä¸­å¹´äººï¼Œä¸€ä¸ªäººé»˜é»˜æŠ½å®Œä¸€æ”¯çƒŸæ‰è¿›é—¨ã€‚

ä½ çªç„¶æ„è¯†åˆ°ï¼šèˆå…åªæ˜¯ä¸€ä¸ªâ€œæƒ…ç»ªä¸­è½¬ç«™â€ï¼Œè°éƒ½å¯ä»¥è¿›æ¥ï¼Œä¹Ÿè°éƒ½ä¼šç¦»å¼€ã€‚`,
      options: [
        { text: "å·®ä¸å¤šäº†ï¼Œå»ä¹°ç¥¨è¿›åœº", effects: { confidence: 4 }, next: "lobby_front", log: "ä½ æŒ‰ç­æ‰‹é‡Œé‚£æ ¹ä¸å­˜åœ¨çš„çƒŸï¼Œè¿ˆå‘æ”¶é“¶å°ã€‚" }
      ]
    },

    lobby_front: {
      areaKey: "lobby",
      title: "å‰å°å¤§å… Â· è´­ç¥¨å…¥åœº",
      text: `æ”¶é“¶å°ä¸Šæ”¾ç€å°éŸ³ç®±ï¼Œæ”¾ç€ä¸€é¦–ä½ å«ä¸å‡ºåå­—çš„æ‹‰ä¸æ›²ã€‚

æœåŠ¡å‘˜æŠ¬çœ¼çœ‹ä½ ä¸€çœ¼ï¼šâ€œæŠ±æŠ±èˆåœºï¼Œå•äººç¥¨ 50ï¼Œä¸€é¦– 20ï¼Œä¸è®¸æ‹ç…§ã€‚â€

å¯¹äº {roleAlias} æ¥è¯´ï¼Œè¿™å¯èƒ½æ˜¯ä»Šæ™šç¬¬ä¸€ç¬”â€œéç†æ€§æ¶ˆè´¹â€ã€‚`,
      onEnter: function (state) {
        if (!state.flags.ticket) {
          state.cash -= 50;
          if (state.cash < 0) state.cash = 0;
          state.flags.ticket = true;
          addLogLine("ğŸ« ä½ æ”¯ä»˜äº† 50 å…ƒé—¨ç¥¨ï¼Œè·å¾—è¿›å…¥ç ‚èˆå…çš„èµ„æ ¼ã€‚");
        }
      },
      options: [
        { text: "è¿›å¤§å…ï¼Œç†Ÿæ‚‰èˆå…æ•´ä½“å¸ƒå±€ï¼ˆ+è§‚å¯Ÿï¼‰", effects: { awareness: 6 }, next: "map_lobby", log: "ä½ èµ°è¿›å¤§å…ï¼Œç¯å…‰ä¸€ä¸‹å­ç ¸åœ¨ä½ èº«ä¸Šã€‚"},
        { text: "å…ˆæ‰¾æ´—æ‰‹é—´ï¼Œè°ƒæ•´ä¸€ä¸‹çŠ¶æ€", next: "map_corridor", log: "ä½ é—®äº†ä¸‹æœåŠ¡å‘˜å•æ‰€çš„ä½ç½®ï¼Œé¡ºåŠ¿å¾€èµ°å»Šé‡Œèµ°ã€‚"}
      ]
    },

    // ===== å„åŒºåŸŸâ€œåœ°å›¾åœºæ™¯â€ï¼šå¼€æ”¾æ²™ç›’æ ¸å¿ƒ =====

    map_lobby: {
      areaKey: "lobby",
      title: "å¤§å… Â· èˆå…ä¸­æ¢",
      text: `è¿™é‡Œæ˜¯åä¸œç ‚ç ‚èˆå…çš„ä¸­æ¢ï¼š

å‰é¢æ˜¯èˆæ± å…¥å£ï¼›
å·¦ä¾§æ˜¯å§å°å’Œå­˜åŒ…ï¼›
å³ä¾§æ˜¯å¡åº§åŒºï¼›
å¾€åæ˜¯å¸çƒŸåŒºå’Œèµ°å»Šã€‚

æ–°äººå»ºè®®ï¼š
å…ˆåœ¨å¤§å…å¤šåœç•™å‡ åˆ†é’Ÿï¼Œçœ‹ä¸€çœ‹ï¼šè°èµ°å‘èˆæ± ï¼Œè°åªå¾€å§å°é ã€‚`,
      options: [
        { text: "èµ°å‘èˆæ± å…¥å£ï¼ˆå‰æ–¹ï¼‰", next: "map_dancefloor", log: "ä½ é¡ºç€éŸ³ä¹æ›´å“çš„æ–¹å‘ï¼Œå¾€èˆæ± èµ°å»ã€‚"},
        { text: "å»å§å°é‚£è¾¹çœ‹çœ‹ï¼Œäº†è§£ä»·æ ¼å’Œäººç¾¤ï¼ˆå·¦ä¾§ï¼‰", next: "map_bar", log: "ä½ å‘å·¦èµ°å»ï¼Œå§å°çš„ç¯å…‰æ¯”èˆæ± æŸ”å’Œä¸€äº›ã€‚"},
        { text: "å»å¡åº§åŒºï¼Œçœ‹çœ‹å“ªäº›äººåªèŠå¤©ä¸è·³èˆï¼ˆå³ä¾§ï¼‰", next: "map_seats", log: "ä½ å¾€å¡åº§æ–¹å‘èµ°å»ï¼Œé‚£è¾¹çš„éŸ³ä¹ä¼¼ä¹å°ä¸€å·ã€‚"},
        { text: "å¾€åèµ°ï¼Œå»å¸çƒŸåŒº/èµ°å»Šï¼ˆåæ–¹ï¼‰", next: "map_smoking", log: "ä½ å†³å®šå…ˆçœ‹çœ‹å¸çƒŸåŒºèšé›†äº†äº›ä»€ä¹ˆäººã€‚"},
        { text: "å‘è€èˆå®¢è¯·æ•™ï¼šæ–°äººåæ¡æ³¨æ„äº‹é¡¹", next: "info_newbie10", log: "ä½ åœ¨å¤§å…ç¢°åˆ°ä¸€ä¸ªè€èˆå®¢ï¼Œä»–é€’ç»™ä½ ä¸€ä»½â€œæ–°äººåæ¡â€ã€‚"}
      ]
    },

    map_dancefloor: {
      areaKey: "dancefloor",
      title: "èˆæ± ä¸­å¤® Â· æŠ±æŠ±èˆä¸»æˆ˜åœº",
      text: `ä½ æ¥åˆ°äº†èˆæ± è¾¹ç¼˜ã€‚

ç¯å…‰åœ¨å¤´é¡¶æ™ƒåŠ¨ï¼Œç”·å¥³æŠ±åœ¨ä¸€èµ·ï¼Œéšç€éŸ³ä¹ç¼“æ…¢åœ°æ‘‡æ™ƒâ€”â€”å…¸å‹çš„æŠ±æŠ±èˆç ‚èˆåœºæ™¯ã€‚

å»ºè®®ï¼š
åˆ«æ€¥ç€å†²è¿›å»ï¼Œå…ˆçœ‹å‡ è½®ï¼Œå­¦ä¼šâ€œçœ‹èˆæ± é‡Œçš„ä½™ç”Ÿâ€ã€‚`,
      options: [
        { text: "ç«™åœ¨èˆæ± è¾¹ï¼Œè§‚å¯Ÿèˆå¥³å’Œç”·å®¢çš„äº’åŠ¨ï¼ˆ+è§‚å¯Ÿï¼Œ+å°‘é‡èˆæŠ€ï¼‰", effects: { awareness: 6, dance: 3 }, next: "dancefloor_observe", log: "ä½ ç´§è´´ç€èˆæ± è¾¹ç¼˜ï¼Œå¼€å§‹å½“ä¸€åè§‚å¯Ÿå‘˜ã€‚"},
        { text: "ç›´æ¥èµ°å‘èˆå¥³é˜Ÿåˆ—ï¼Œå‡†å¤‡ç‚¹èˆï¼ˆå‰æ–¹ï¼‰", next: "map_girlline", log: "ä½ ç»•è¿‡èˆæ± ï¼Œèµ°å‘ç¯å…‰æœ€äº®çš„ä¸€æ’èˆå¥³ã€‚"},
        { text: "å¾€å¤§å…é€€å›å»ï¼ˆåæ–¹ï¼‰", next: "map_lobby", log: "ä½ è§‰å¾—èŠ‚å¥æœ‰ç‚¹å¿«ï¼Œå…ˆé€€å›å¤§å…ã€‚"},
        { text: "é—®é—®æ—è¾¹çš„è€èˆå®¢ï¼šå¦‚ä½•æŒ‘é¿å‘èˆå¥³ï¼Ÿ", next: "info_avoidTraps", log: "ä½ ä¾§å¤´å’Œæ—è¾¹è€èˆå®¢æ­è®ªï¼Œä»–æ‚„æ‚„ç»™ä½ å‡ æ¡é¿å‘å»ºè®®ã€‚"},
        { text: "çªç„¶æœ‰ç‚¹æ„Ÿæ…¨ï¼šèˆæ± é‡Œçš„ä½™ç”Ÿæ˜¯å•¥æ ·ï¼Ÿ", next: "info_suwurenjian", log: "ä½ çœ‹ç€èˆæ± ï¼Œè„‘å­é‡Œå†’å‡ºä¸€äº›å¾ˆä¸§çš„ç”»é¢ã€‚"}
      ]
    },

    dancefloor_observe: {
      areaKey: "dancefloor",
      title: "è§‚å¯Ÿèˆæ±  Â· è°åœ¨è·³èˆï¼Œè°åœ¨è·³é’±åŒ…ï¼Ÿ",
      text: `ä½ è®¤çœŸçœ‹äº†å‡ è½®ï¼š

â€” æœ‰çš„äººæŠ±å¾—å¾ˆç´§ï¼Œçœ¼ç¥å´ç©ºç©ºçš„ã€‚
â€” æœ‰çš„è€å¤´æ­¥å­è€æ´¾ï¼Œå´èŠ‚å¥ç¨³ï¼Œèˆå¥³æ„¿æ„å¤šè·³å‡ é¦–ã€‚
â€” æœ‰çš„èˆå¥³å¯¹è°éƒ½ç¬‘ï¼Œæœ‰çš„åªå¯¹å°‘æ•°äººç¬‘ã€‚

ä½ æ…¢æ…¢æ˜ç™½äº†é‚£å¥è¯ï¼š
â€œæœ‰äººæ·±çˆ±ï¼Œä»–ä»¬è·³èˆï¼›æœ‰äººæ— çˆ±ï¼Œä»–ä»¬è·³èˆï¼›æœ‰äººå¤±çˆ±ï¼Œä»ç„¶è·³èˆã€‚â€`,
      options: [
        { text: "è‡ªå·±åœ¨è§’è½ç»ƒç»ƒä¸‰æ­¥å’ŒæŠ±ä½ï¼ˆ+èˆæŠ€ï¼Œ+è‡ªä¿¡ï¼‰", effects: { dance: 6, confidence: 6, stamina: -5 }, next: "dancefloor_practice", log: "ä½ åœ¨è§’è½è·Ÿç€éŸ³ä¹è½»è½»è¸æ­¥ï¼Œè¯•ç€æ‰¾åˆé€‚çš„æŠ±ä½ã€‚"},
        { text: "è§‚å¯Ÿå¤Ÿäº†ï¼Œå‡†å¤‡å»æŒ‘ä¸€ä½èˆå¥³", next: "map_girlline", log: "ä½ è§‰å¾—å·®ä¸å¤šäº†ï¼Œå‡†å¤‡å»èˆå¥³é˜Ÿåˆ—é‚£è¾¹æŒ‘äººã€‚"}
      ]
    },

    dancefloor_practice: {
      areaKey: "dancefloor",
      title: "èº«ä½“è®°ä½äº†èŠ‚å¥",
      text: `ä½ ä¸€è¾¹é»˜å¿µâ€œå·¦ã€å³ã€å·¦ï¼›å³ã€å·¦ã€å³â€ï¼Œä¸€è¾¹è¯•ç€æƒ³è±¡æ‹¥æŠ±çš„è·ç¦»ã€‚

ä¸ç®¡ä½ æ˜¯ {roleName}ï¼Œæ­¤åˆ»èº«ä½“æ…¢æ…¢ç›–è¿‡äº†å¤§è„‘çš„ç´§å¼ ã€‚

ä½ å¯¹èˆæ± çš„ææƒ§ç¨å¾®å‡è½»äº†ä¸€ç‚¹ã€‚`,
      options: [
        { text: "è¶æ‰‹æ„Ÿä¸é”™ï¼Œç›´æ¥å»èˆå¥³é˜Ÿåˆ—ç‚¹èˆ", effects: { confidence: 5 }, next: "map_girlline", log: "ä½ æ“¦äº†æ“¦æ‰‹å¿ƒçš„æ±—ï¼Œèµ°å‘èˆå¥³é˜Ÿåˆ—ã€‚"},
        { text: "åœä¸‹æ¥ï¼Œå»å¸çƒŸåŒºå¬å¬è€èˆå®¢è®²â€œæœºè½¦æ•…äº‹â€", next: "map_smoking", log: "ä½ å†³å®šè¾¹æŠ½çƒŸè¾¹å¬å…«å¦ã€‚"}
      ]
    },

    map_girlline: {
      areaKey: "girlline",
      title: "èˆå¥³é˜Ÿåˆ— Â· ç¯å…‰ä¸‹çš„é€‰æ‹©",
      text: `ä½ æ¥åˆ°ç¯å…‰æœ€äº®çš„ä¸€å—åŒºåŸŸã€‚

ä¸€æ•´æ’èˆå¥³ç«™åœ¨æ æ†æ—ï¼š
æœ‰ç©¿çŸ­è£™çš„ï¼Œæœ‰ç©¿ç‰›ä»”è£¤çš„ï¼Œæœ‰ç©¿é•¿è£™çš„ï¼Œæœ‰æˆ´å£ç½©çš„ã€‚

å¥¹ä»¬æœ‰çš„ç©æ‰‹æœºï¼Œæœ‰çš„èŠå¤©ï¼Œæœ‰çš„æ—¶ä¸æ—¶çœ‹å‘èˆæ± ã€‚`,
      options: [
        { text: "è®¤çœŸè§‚å¯Ÿï¼Œåˆ†è¾¨å“ªäº›å¯èƒ½æ˜¯æœºè½¦èˆå¥³ï¼ˆ+è§‚å¯Ÿï¼Œ+æŠ—PUAï¼‰", effects: { awareness: 8, antiPua: 6 }, next: "girlline_machineCheck", log: "ä½ æ²¡æœ‰ç«‹åˆ»ç‚¹èˆï¼Œè€Œæ˜¯ä»”ç»†æ‰“é‡æ¯ä¸€ä¸ªäººã€‚"},
        { text: "æŒ‘ä¸€ä¸ªç¬‘å¾—ç‰¹åˆ«ç”œã€æœä½ æŒ¥æ‰‹çš„èˆå¥³ï¼ˆé«˜å±ï¼‰", effects: { confidence: 5, antiPua: -4 }, next: "sweetGirl", log: "ä½ è¿˜æ˜¯è¢«é‚£å¼ ç”œç”œçš„ç¬‘è„¸å¸ä½äº†ã€‚"},
        { text: "æŒ‘ä¸€ä¸ªç«™å§¿è‡ªç„¶ã€ä¸æŠ¢çœ¼ä½†é¡ºçœ¼çš„èˆå¥³ï¼ˆç›¸å¯¹å®‰å…¨ï¼‰", effects: { awareness: 3, antiPua: 5 }, next: "safeGirl", log: "ä½ é€‰äº†ä¸€ä¸ªç©¿æ™®é€šè¿è¡£è£™çš„èˆå¥³ã€‚"},
        { text: "é€€å›èˆæ± è¾¹ï¼Œç»§ç»­å½“è§‚å¯Ÿå‘˜", next: "map_dancefloor", log: "ä½ è§‰å¾—è‡ªå·±è¿˜æ²¡å‡†å¤‡å¥½ï¼Œå…ˆå›èˆæ± è¾¹çœ‹çœ‹ã€‚"},
        { text: "å‘æ—è¾¹è€èˆå®¢è¯·æ•™ï¼šå¦‚ä½•è¯†åˆ«æœºè½¦èˆå¥³ï¼Ÿ", next: "info_machineGuide", log: "è€èˆå®¢å‹ä½å£°éŸ³è·Ÿä½ è®²äº†å‡ æ¡â€œæœºè½¦è¯†åˆ«æŒ‡å—â€ã€‚"}
      ]
    },

    girlline_machineCheck: {
      areaKey: "girlline",
      title: "æœºè½¦æ‰«ææ¨¡å¼ Â· ON",
      text: `ä½ æŒ‰ç…§åˆšåˆšå¬æ¥çš„æœºè½¦æŒ‡å—å¼€å§‹ç­›é€‰ï¼š

â€” é«˜é¢†æ— æ‰£é•¿è¢– + ç‰›ä»”è£¤ï¼Œæ“ä½œç©ºé—´å°ï¼Œå¤šåŠåªå–è„¸ä¸å–ä½“éªŒã€‚
â€” ä¸‰äº”æˆç¾¤æ‰å †èŠå¤©ï¼Œå¾ˆä¹…æ²¡äººä¸Šå‰é‚€èˆï¼Œå¤šåŠæ˜¯â€œæœºè½¦èšé›†åœ°â€ã€‚
â€” ç»å¸¸ä¸€æ›²æœªå®Œå°±æŠŠå®¢äººæ”¾ç”Ÿï¼Œè¿˜ä¼šåœ¨èˆæ± é‡Œåµæ¶çš„ï¼Œåƒä¸‡åˆ«è¯•ã€‚`,
      options: [
        { text: "æ’é™¤æœºè½¦åŒºï¼Œä»å‰©ä¸‹çš„èˆå¥³é‡Œé€‰ä¸€ä¸ªæœ€é¡ºçœ¼çš„", effects: { awareness: 4, antiPua: 6 }, next: "safeGirl", log: "ä½ åˆ»æ„é¿å¼€æœºè½¦èšé›†åŒºï¼Œé”å®šäº†ä¸€ä¸ªæ­£å¸¸è¥ä¸šçš„èˆå¥³ã€‚"},
        { text: "éšç¼˜ï¼Œé—­çœ¼ä¹±æŒ‡ä¸€ä¸ªï¼ˆé«˜éšæœºé«˜é£é™©ï¼‰", effects: { awareness: -2 }, next: "sweetGirl", log: "ä½ å†³å®šç›¸ä¿¡ç¼˜åˆ†ï¼Œä¹Ÿç›¸ä¿¡è‡ªå·±çš„è¿æ°”ã€‚"}
      ]
    },

    // ===== ä¿¡æ¯åœºæ™¯ =====

    info_newbie10: {
      areaKey: "lobby",
      title: "ç ‚èˆ 10 ç‚¹æ³¨æ„äº‹é¡¹ Â· æ–°äººé¡»çŸ¥",
      text: text_newbie10,
      options: [
        { text: "è®°ä½è¿™äº›ï¼Œå†å›åˆ°å¤§å…ç»§ç»­é€›", next: "map_lobby", log: "ä½ æŠŠâ€œæ–°äººåæ¡â€åœ¨å¿ƒé‡Œé»˜å¿µäº†ä¸€éï¼Œå‡†å¤‡è¿›å…¥ä¸‹ä¸€æ­¥ã€‚"}
      ]
    },

    info_history: {
      areaKey: "smoking",
      title: "èˆå…å†å² Â· æ–°äººåŸºç¡€ç¯‡",
      text: text_history,
      options: [
        { text: "å¬å®Œæ•…äº‹ï¼Œå›åˆ°å¸çƒŸåŒºç»§ç»­è§‚å¯Ÿ", next: "map_smoking", log: "ä½ æç­çƒŸå¤´ï¼Œå†å²å¬å¤Ÿäº†ï¼Œè¯¥å›ç°å®äº†ã€‚"}
      ]
    },

    info_machineGuide: {
      areaKey: "girlline",
      title: "åä¸œèˆå… Â· é˜²æœºè½¦åŸºç¡€æŒ‡å—",
      text: text_machineGuide,
      options: [
        { text: "ç‰¢è®°æœºè½¦ç‰¹å¾ï¼Œå›é˜Ÿåˆ—é‡æ–°æŒ‘äºº", next: "map_girlline", log: "ä½ è§‰å¾—è‡ªå·±è‡³å°‘ä¸ç®—â€œçº¯æ–°æ‰‹â€äº†ã€‚"}
      ]
    },

    info_avoidTraps: {
      areaKey: "dancefloor",
      title: "å¦‚ä½•é¿å…è¢«èˆå¥³å¥—è·¯ï¼Ÿ",
      text: text_avoidTraps,
      options: [
        { text: "è®°åœ¨å¿ƒé‡Œï¼Œç»§ç»­ç›¯ç€èˆæ± çœ‹", next: "map_dancefloor", log: "ä½ åœ¨å¿ƒé‡Œç»™è‡ªå·±åŠ äº†ä¸€æ¡ï¼šè·³å®Œå°±èµ°ï¼Œä¸ç•™å°¾å·´ã€‚"}
      ]
    },

    info_suwurenjian: {
      areaKey: "dancefloor",
      title: "ã€Šè‹èˆäººé—´ã€‹ Â· èˆæ± é‡Œçš„ä½™ç”Ÿ",
      text: text_suwurenjian,
      options: [
        { text: "æ”¶èµ·æ„Ÿæ…¨ï¼Œå›èˆæ± è¾¹çœ‹ç°å®ç‰ˆä½™ç”Ÿ", next: "map_dancefloor", log: "ä½ é•¿å‡ºä¸€å£æ°”ï¼Œå†³å®šæš‚æ—¶åˆ«å¤ªæ–‡è‰ºã€‚"}
      ]
    },

    info_dragonGirl: {
      areaKey: "corridor",
      title: "é¾™å¥³å¿ƒé­” Â· ç®€çŸ­æé†’",
      text: text_dragonGirl,
      options: [
        { text: "ç‚¹ç‚¹å¤´ï¼šä»¥åé‡åˆ°æˆ´å£ç½©çš„é¾™å¥³ï¼Œè¦æ›´å†·é™", next: "map_corridor", log: "ä½ é»˜é»˜å¯¹è‡ªå·±è¯´ï¼šä¸è¦åªç›¯ç€å¥¹ä»¬çš„çœ¼ç›çœ‹ã€‚"}
      ]
    },

    // å§å° / å¡åº§ / å¸çƒŸåŒº / èµ°å»Š åœ°å›¾

    map_bar: {
      areaKey: "bar",
      title: "å§å° Â· ä¸è·³èˆçš„åœ°æ–¹",
      text: `å§å°ç¯å…‰åæš–ï¼ŒéŸ³é‡æ¯”èˆæ± å°ä¸€äº›ã€‚

æœ‰äººåœ¨è¿™é‡Œå–é¥®æ–™ã€åˆ·æ‰‹æœºã€å’Œèˆå¥³èŠå¤©ï¼Œä¹Ÿæœ‰äººåªæ˜¯é™é™åç€ã€‚

è¿™é‡Œæ˜¯ï¼š
â€” æ¢é›¶é’±çš„åœ°æ–¹ï¼›
â€” å¬å…«å¦çš„åœ°æ–¹ï¼›
â€” å¶å°”â€œè¢«èˆå¥³è¦ç¤¼ç‰©â€çš„åœ°æ–¹ã€‚`,
      options: [
        { text: "ç‚¹ä¸€æ¯æœ€ä¾¿å®œçš„é¥®æ–™ï¼Œå¬å¬æ—è¾¹äººèŠå¤©ï¼ˆ-20 ç°é‡‘ï¼‰", effects: { cash: -20, awareness: 4 }, next: "bar_listen", log: "ä½ ç‚¹äº†ä¸€æ¯é¥®æ–™ï¼Œå‡è£…çœ‹æ‰‹æœºï¼Œè€³æœµå´ç«–å¾—å¾ˆç›´ã€‚"},
        { text: "è¿œç¦»å§å°ï¼Œå›å¤§å…èµ°èµ°", next: "map_lobby", log: "ä½ å¯¹å§å°çš„ç¤¾äº¤ä¸æ„Ÿå…´è¶£ï¼Œé€‰æ‹©å›å¤§å…ã€‚"},
        { text: "å»å¡åº§åŒºçœ‹çœ‹ï¼ˆå³ä¾§ï¼‰", next: "map_seats", log: "ä½ ä»å§å°ç»•è¿‡å»ï¼Œè¿›å…¥å¡åº§åŒºã€‚"}
      ]
    },

    bar_listen: {
      areaKey: "bar",
      title: "å§å°å…«å¦ Â· è°æ˜¯å¸¸å®¢ï¼Ÿ",
      text: `ä½ å¬è§å‡ ä¸ªå…³é”®è¯ï¼š

â€œæ˜¨å¤©æŸä¸ªè€å¤´è¢«èˆå¥³å¥—äº†å¥½å‡ åƒã€‚â€â€œæœ‰ä¸ªèˆå¥³ç»å¸¸å€Ÿé’±ä»ä¸è¿˜ã€‚â€â€œæœ‰ä¸ªç”·äººå–æˆ¿æ¢é™ªä¼´è¢«å®¶é‡Œäººæ‹¦ä¸‹ã€‚â€â€¦â€¦

ä½ çªç„¶æ„è¯†åˆ°ï¼š
æœ‰äººåªæ˜¯æ¥è·³èˆï¼Œæœ‰äººå´çœŸçš„åœ¨è¿™é‡ŒèµŒå‘½ã€‚`,
      options: [
        { text: "æš—æš—è®°ä½è¿™äº›æ•…äº‹ï¼Œå›å¤§å…", next: "map_lobby", log: "ä½ å–å®Œé¥®æ–™ï¼Œå¿ƒé‡Œå¤šäº†ä¸€å±‚æˆ’å¿ƒã€‚"},
        { text: "å»å¸çƒŸåŒºé€é€æ°”ï¼ˆåæ–¹ï¼‰", next: "map_smoking", log: "ä½ è§‰å¾—è¿™äº›æ•…äº‹æœ‰ç‚¹æ²‰ï¼Œå†³å®šå»é€æ°”ã€‚"}
      ]
    },

    map_seats: {
      areaKey: "seats",
      title: "å¡åº§åŒº Â· èŠå¤©ä¸æœºè½¦èšé›†åœ°",
      text: `è¿™é‡Œç¯å…‰æŸ”å’Œï¼ŒéŸ³ä¹ç¨å¾®å°ä¸€ç‚¹ã€‚

èˆå¥³åœ¨è¿™é‡Œæ¢é‹ã€èŠå…«å¦ã€åˆ·è§†é¢‘ã€‚
ä¸€äº›æœºè½¦èˆå¥³ä¼šåœ¨è¿™é‡Œæ‰å †èŠå¤©ï¼Œç­‰å¾…â€œå†¤å¤§å¤´â€ä¸Šé—¨ã€‚`,
      options: [
        { text: "è¿œè¿œè§‚å¯Ÿï¼šå“ªäº›äººä¸€ç›´ä¸ä¸‹åœºï¼Œå“ªäº›äººæ€»è¢«æ”¾ç”Ÿï¼ˆ+è§‚å¯Ÿï¼‰", effects: { awareness: 6 }, next: "seats_observe", log: "ä½ ååœ¨è§’è½çš„ç©ºä½ä¸Šï¼Œé»˜é»˜è§‚å¯Ÿè¿™äº›äººçš„æµåŠ¨ã€‚"},
        { text: "è¿”å›å¤§å…ï¼ˆå‰æ–¹ï¼‰", next: "map_lobby", log: "ä½ è§‰å¾—è¿™é‡Œçš„ç©ºæ°”æœ‰ç‚¹é»è…»ï¼Œå†³å®šå›å¤§å…ã€‚"},
        { text: "å»å§å°å–å£ä¸œè¥¿ï¼ˆå·¦ä¾§ï¼‰", next: "map_bar", log: "ä½ ä»å¡åº§ç»•å›å§å°ã€‚"}
      ]
    },

    seats_observe: {
      areaKey: "seats",
      title: "æœºè½¦èšé›†åœ° Â· è§‚å¯Ÿè®°å½•",
      text: `ä½ æ³¨æ„åˆ°ï¼š

â€” æœ‰å‡ ä¸ªèˆå¥³å‡ ä¹ä¸€ç›´åœ¨å¡åº§èŠå¤©ï¼Œå¶å°”æœ‰äººå°è¯•è¯·å¥¹ä»¬è·³ï¼Œä¸€ä¼šå„¿å°±è¢«æ”¾å›åŸåœ°ã€‚
â€” æœ‰çš„èˆå¥³æ¥å¡åº§åªæ˜¯æ­‡ä¸€ä¼šå„¿ï¼Œå¾ˆå¿«åˆå›èˆæ± è¥ä¸šã€‚

ä½ å¤§è‡´åˆ†è¾¨å‡ºï¼š
â€œæ€»å¾…åœ¨å¡åº§çš„è„¸å¥½çœ‹ä½†ä¸è·³çš„â€ï¼Œå¾€å¾€æ˜¯æœºè½¦ä¸­çš„æœºè½¦ã€‚`,
      options: [
        { text: "æŠŠè¿™äº›åŠ å…¥â€œé»‘åå•â€ï¼Œå›èˆå¥³é˜Ÿåˆ—é‡æ–°æŒ‘äºº", next: "map_girlline", log: "ä½ å†³å®šé¿å¼€åˆšåˆšè§‚å¯Ÿåˆ°çš„é‚£ä¸€ç‰‡å¡åº§ã€‚"},
        { text: "æ¢ä¸ªåœ°æ–¹é€é€æ°”ï¼Œå»å¸çƒŸåŒº", next: "map_smoking", log: "ä½ èµ·èº«å¾€å¸çƒŸåŒºèµ°å»ã€‚"}
      ]
    },

    map_smoking: {
      areaKey: "smoking",
      title: "å¸çƒŸåŒº Â· è€èˆå®¢æƒ…æŠ¥ç«™",
      text: `è¿™é‡Œæ˜¯æ•´ä¸ªèˆå…ä¿¡æ¯æœ€å¯†é›†çš„åœ°æ–¹ã€‚

æœ‰äººæŠ½çƒŸï¼Œæœ‰äººé—²èŠï¼Œæœ‰äººåæ§½èˆå¥³ï¼Œæœ‰äººè®²â€œä»Šå¤©åˆè¢«è°å¥—è·¯äº†â€ã€‚

åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥ç”¨å‡ æ”¯çƒŸçš„æ—¶é—´ï¼Œå¬å®Œåˆ«äººç”¨å‡ å¹´æ¢æ¥çš„æ•™è®­ã€‚`,
      options: [
        { text: "æ‰¾ä¸ªè€èˆå®¢ï¼ŒèŠèŠâ€œç ‚èˆå†å²â€å’Œå…¨å›½èˆå…åˆ†å¸ƒ", next: "info_history", log: "ä½ ä¸»åŠ¨æ­è¯ï¼Œè€èˆå®¢å¾ˆä¹æ„ç»™ä½ è®²å†å²æ•…äº‹ã€‚"},
        { text: "è¯·æ•™ï¼šç©èˆå…å‰ï¼Œåº”è¯¥å…ˆæƒ³æ˜ç™½å“ªäº›é—®é¢˜ï¼Ÿ", next: "smoking_philosophy", log: "è€èˆå®¢é—®äº†ä½ å‡ ä¸ªâ€œå“²å­¦ä¸‰é—®â€çš„å˜ç§ã€‚"},
        { text: "æŠ½å®Œä¸€æ”¯çƒŸï¼Œå»èˆæ± è¾¹çœ‹çœ‹ç°åœº", next: "map_dancefloor", log: "ä½ æ‹äº†æ‹è£¤å­ä¸Šçš„çƒŸç°ï¼Œå¾€èˆæ± èµ°å»ã€‚"},
        { text: "å¾€èµ°å»Šæ–¹å‘èµ°ï¼Œçœ‹çœ‹å•æ‰€é‚£è¾¹æœ‰ä»€ä¹ˆå…«å¦", next: "map_corridor", log: "ä½ å¾€èµ°å»Šæ·±å¤„èµ°å»ï¼Œé‚£é‡Œæ€»æœ‰å¥‡æ€ªçš„ä¿¡æ¯ã€‚"}
      ]
    },

    smoking_philosophy: {
      areaKey: "smoking",
      title: "ç©å‰å‡†å¤‡ Â· èˆå…ç‰ˆå“²å­¦ä¸‰é—®",
      text: `è€èˆå®¢é—®ä½ ï¼š

â€œä½ ç©èˆå…ä¹‹å‰ï¼Œæƒ³æ²¡æƒ³è¿‡å‡ ä¸ªé—®é¢˜ï¼Ÿâ€

â€” æˆ‘æ˜¯è°ï¼Ÿï¼ˆæˆ‘æ˜¯ä»€ä¹ˆèº«ä»½æ¥çš„ï¼Ÿï¼‰
â€” æˆ‘ä»å“ªé‡Œæ¥ï¼Ÿï¼ˆæˆ‘ç°å®ç”Ÿæ´»ä»€ä¹ˆçŠ¶æ€ï¼Ÿï¼‰
â€” æˆ‘è¦åˆ°å“ªé‡Œå»ï¼Ÿï¼ˆæˆ‘æ¥èˆå…åˆ°åº•è¦å•¥ï¼Ÿï¼‰

å†ç»†ä¸€ç‚¹ï¼š
â€” æˆ‘æœ‰å•¥ï¼Ÿï¼ˆé¢„ç®—ã€ç²¾åŠ›ã€å©šå§»çŠ¶å†µã€å¿ƒç†æ‰¿å—åŠ›ï¼‰
â€” æˆ‘æƒ³è¦å•¥ï¼Ÿï¼ˆåªæ˜¯è·³èˆï¼Ÿæ‰¾äººèŠå¤©ï¼Ÿæ‰¾äººå‡ºå»ï¼Ÿï¼‰
â€” ä¸ºäº†å¾—åˆ°è¿™äº›ï¼Œæˆ‘æ„¿æ„æ”¾å¼ƒå•¥ï¼Ÿï¼ˆé’±ã€æ—¶é—´ã€åå£°ã€å®¶åº­ï¼Ÿï¼‰

ä»–è¯´ï¼š
â€œæŠŠè¿™äº›é—®é¢˜ææ¸…æ¥šï¼Œç©ç ‚èˆå°±æ˜¯è½»æ¾æ„‰å¿«å››ä¸ªå­—ï¼›æä¸æ¸…æ¥šï¼Œå°±å®¹æ˜“ç©æˆæ‚²å‰§ã€‚â€`,
      options: [
        { text: "è‹¥æœ‰æ‰€æ€åœ°ç‚¹ç‚¹å¤´ï¼Œå›å¸çƒŸåŒºç»§ç»­å¬å…«å¦", next: "map_smoking", log: "è¿™äº›é—®é¢˜åœ¨ä½ å¿ƒé‡Œç§äº†ä¸€é¢—å°å°çš„ç§å­ã€‚"}
      ]
    },

    map_corridor: {
      areaKey: "corridor",
      title: "èµ°å»Š / å•æ‰€å£ Â· å°é“æ¶ˆæ¯åŒº",
      text: `å•æ‰€é—¨å£æ€»æ˜¯ä¿¡æ¯æœ€å¤æ‚çš„åœ°æ–¹ï¼š

â€” èˆå¥³åœ¨è¿™è¡¥å¦†ã€æ¢ä¸è¢œã€æ¥ç”µè¯ã€‚
â€” å®¢äººæ¥æ¥å›å›ï¼Œæœ‰äººé†‰äº†ï¼Œæœ‰äººæ¸…é†’äº†ã€‚

æœ‰æ—¶å€™ï¼Œæœ€çœŸå®çš„è¯ï¼Œåè€Œæ˜¯åœ¨è¿™é‡Œè¯´å‡ºå£ã€‚`,
      options: [
        { text: "å¬åˆ°æœ‰äººè®¨è®ºâ€œé¾™å¥³â€ï¼Œå‡‘è¿‡å»å¬ä¸¤å¥", next: "info_dragonGirl", log: "ä½ å¬è§æœ‰äººæåˆ°â€œé¾™å¥³â€ä¸¤ä¸ªå­—ï¼Œå¿ä¸ä½å¤šå¬äº†ä¸€ä¼šã€‚"},
        { text: "è§£å†³ä¸€ä¸‹ä¸ªäººé—®é¢˜ï¼Œè°ƒæ•´å¿ƒæ€å†å›èˆæ± ", next: "map_dancefloor", log: "ä½ æ´—äº†æŠŠè„¸ï¼Œçœ‹å‘é•œå­é‡Œçš„è‡ªå·±ï¼Œç„¶åå¾€èˆæ± èµ°å»ã€‚"},
        { text: "ä»èµ°å»Šç»•å›å¤§å…", next: "map_lobby", log: "ä½ æ²¿ç€èµ°å»Šå›åˆ°å¤§å…ã€‚"}
      ]
    },

    // ===== èˆå¥³äº’åŠ¨ï¼šç”œå¿ƒ & å®‰å…¨çº¿ï¼ˆæŠ±æŠ±èˆå‰§æƒ…ï¼‰ =====

    sweetGirl: {
      areaKey: "dancefloor",
      title: "ç”œå¿ƒå‹èˆå¥³ Â· æŠ±æŠ±èˆçš„æƒ…ç»ªé™·é˜±",
      text: `ä½ èµ°åˆ°é‚£ä½ç¬‘å®¹æœ€ç”œçš„èˆå¥³é¢å‰ï¼Œå¥¹æ—©å°±æ³¨æ„åˆ°ä½ äº†ã€‚

éŸ³ä¹ä¸€å“ï¼Œå¥¹ä¸Šå‰ä¸€æ­¥ï¼Œè‡ªç„¶åœ°æŠ±ä½ä½ ï¼ŒåŒæ‰‹æ­åœ¨ä½ çš„è‚©è†€ä¸Šï¼Œä½ çš„æ‰‹æ‰¶åœ¨å¥¹åèƒŒã€‚

â€œç¬¬ä¸€æ¬¡æ¥å§ï¼Ÿâ€å¥¹åœ¨ä½ è€³è¾¹è½»å£°é—®ï¼Œé¦™æ°´å‘³å’Œèˆæ± çš„æ··åˆæ°”å‘³è®©äººæœ‰ç‚¹æ™•ã€‚`,
      warning: "ã€è¯æœ¯è¯†åˆ«ï¼šè½»åº¦æƒ…æ„Ÿæ¤å…¥ã€‘\nç”œå¿ƒå‹èˆå¥³çš„æ€ä¼¤åŠ›ï¼Œä¸åªåœ¨æŠ±å¾—å¤šè¿‘ï¼Œè€Œæ˜¯åœ¨å¥¹è¯´è¯æœ‰å¤šç”œã€‚",
      options: [
        { text: "è€å®æ‰¿è®¤ï¼šæ˜¯ç¬¬ä¸€æ¬¡ï¼Œä»€ä¹ˆéƒ½ä¸å¤ªæ‡‚ï¼ˆ+çœŸè¯šï¼Œ-ä¸€ç‚¹è‡ªä¿¡ï¼‰", effects: { confidence: -3, awareness: 2 }, next: "sweetGirlTalk", log: "ä½ å¦ç™½è‡ªå·±æ˜¯ç¬¬ä¸€æ¬¡æ¥ï¼Œå¥¹çœ¼ç¥æ˜æ˜¾äº®äº†ä¸€ä¸‹ã€‚"},
        { text: "è£…è€ç»ƒï¼šç»å¸¸æ¥ï¼Œåªæ˜¯æœ€è¿‘å¿™ï¼ˆ+è‡ªä¿¡ï¼Œ-æŠ—PUAï¼‰", effects: { confidence: 6, antiPua: -5 }, next: "sweetGirlTalk", log: "ä½ å‡è£…è€æ‰‹ï¼Œå¥¹å¼€å§‹æŠŠä½ å½’ç±»ä¸ºâ€œæ½œåœ¨è€ä¸»é¡¾â€ã€‚"},
        { text: "ä¿æŒå®‰å…¨è·ç¦»ï¼Œåªæ‰“ç®—è·³ä¸€é¦–å°±èµ°", effects: { cash: -20, stamina: -5, confidence: 2, antiPua: 8 }, next: "end_oneSongSafe", log: "ä½ æ§åˆ¶å¥½èº«ä½“è·ç¦»ï¼Œå†³å®šåªè·³å®Œè¿™ä¸€é¦–ã€‚"}
      ]
    },

    sweetGirlTalk: {
      areaKey: "dancefloor",
      title: "â€œä»Šæ™šå¥½æƒ¨å‘€â€ Â· ç»å…¸å°è¯",
      text: `ä½ ä»¬æŠ±ç€éšéŸ³ä¹æ‘‡æ™ƒï¼Œä½ çš„æ­¥å­æœ‰ç‚¹ä¹±ï¼Œå¥¹å´ç¬‘ç€è¯´ï¼š

â€œåˆ«ç´§å¼ ï¼Œä½ æŠ±å¾—æŒºå¥½çš„å‘€ã€‚â€

è¿‡äº†å‡ æ‹ï¼Œå¥¹è½»è½»å¹æ°”ï¼š
â€œä»Šæ™šå¥½æƒ¨å“¦ï¼Œä¸€ç›´æ²¡ä»€ä¹ˆç”Ÿæ„â€¦â€¦ä½ å†å¤šè·³ä¸¤é¦–é™ªé™ªæˆ‘å˜›ï¼Ÿâ€`,
      warning: "ã€è¯æœ¯è¯†åˆ«ï¼šæ¸©æŸ”å‚¬è·³ Â· é«˜å±ã€‘\nå…³é”®è¯ï¼šä»Šæ™šå¥½æƒ¨ã€æ²¡å¼€å¼ ã€é™ªé™ªæˆ‘ â€”â€” æ­£åœ¨æµ‹è¯•ä½ çš„ä»˜è´¹ä¸Šé™ã€‚",
      options: [
        { text: "å¿ƒä¸€è½¯ï¼šé‚£å°±å†è·³å‡ é¦–å§ï¼ˆ-ç°é‡‘ï¼Œ-ä½“åŠ›ï¼Œ+ä¸€ç‚¹è™šå‡çš„äº²å¯†æ„Ÿï¼‰", effects: { cash: -60, stamina: -10, confidence: 5, antiPua: -10 }, next: "end_puaWallet", log: "ä½ è·Ÿç€å¥¹åˆè·³äº†å‡ é¦–ï¼Œé’±åŒ…æ˜æ˜¾ç˜¦äº†ä¸€åœˆã€‚"},
        { text: "ç†æ€§å›åº”ï¼šç¬‘ç€è¯´â€œæˆ‘é¢„ç®—æœ‰é™ï¼Œåªè·³è¿™ä¸€é¦–â€ï¼ˆ+æŠ—PUAï¼‰", effects: { antiPua: 15, confidence: 3 }, next: "end_controlBudget", log: "ä½ ç¨³ç¨³å®ˆä½äº†è‡ªå·±çš„é¢„ç®—ï¼Œå¥¹çš„ç¬‘å®¹æ·¡äº†ä¸€ç‚¹ã€‚"},
        { text: "æ‘Šç‰Œï¼šæˆ‘åªæƒ³ç»ƒæŠ±æŠ±èˆï¼Œä¸åå°ä¸åŠ å¾®ä¿¡", effects: { antiPua: 20, confidence: 5 }, next: "end_coolPlayer", log: "ä½ æŠŠåº•çº¿è¯´å¾—å¾ˆæ¸…æ¥šï¼Œå¥¹æ„£äº†ä¸€ä¸‹ï¼Œåªå¥½è®¤çœŸè·³å®Œè¿™ä¸€é¦–ã€‚"}
      ]
    },

    safeGirl: {
      areaKey: "dancefloor",
      title: "æ™®é€šèˆå¥³ Â· å¹²å‡€çš„ä¸€æ”¯æŠ±æŠ±èˆ",
      text: `å¥¹èµ°åˆ°ä½ é¢å‰ï¼Œæ²¡æœ‰å¤šä½™çš„èŠ±æ‹›ï¼Œåªæ˜¯è‡ªç„¶åœ°å’Œä½ æŠ±åœ¨ä¸€èµ·ã€‚

â€œç¬¬ä¸€æ¬¡æ¥å—ï¼Ÿåˆ«ç´§å¼ ï¼Œè·Ÿç€æˆ‘æ•°èŠ‚å¥å°±è¡Œã€‚â€å¥¹è¯­æ°”å¹³é™ã€‚

ä½ ä»¬èº«ä½“ä¿æŒåœ¨ä¸€ä¸ªèˆ’æœçš„è·ç¦»ï¼Œæ³¨æ„åŠ›éƒ½æ”¾åœ¨æ­¥å­å’ŒèŠ‚å¥ä¸Šã€‚`,
      warning: "ã€æç¤ºï¼šç›¸å¯¹å®‰å…¨ã€‘\nå¥¹ä¸ä¸»åŠ¨ç´¢å–ã€ä¸åšæƒ…ç»ªæ‹‰æ‰¯ï¼Œåªæ˜¯è®¤çœŸåœ°æŠŠè¿™ä¸€æ”¯èˆè·³å¥½ã€‚",
      options: [
        { text: "è®¤çœŸè·Ÿå¥¹çš„èŠ‚å¥ï¼Œå°½é‡ä¸è¸©è„šï¼ˆ+èˆæŠ€ï¼Œ+è‡ªä¿¡ï¼‰", effects: { dance: 10, confidence: 10, stamina: -5 }, next: "safeEnd", log: "ä½ æ¸æ¸æ‰¾åˆ°æŠ±æŠ±èˆçš„èŠ‚å¥æ„Ÿï¼Œè¿™ä¸€é¦–è·³å¾—å‡ºå¥‡é¡ºåˆ©ã€‚"},
        { text: "ä¸€è¾¹è·³ä¸€è¾¹ä¸œå¼ è¥¿æœ›ï¼Œå¿ƒç¥ä¸å®šï¼ˆ+å°‘é‡èˆæŠ€ï¼Œ-ä¸€ç‚¹è‡ªä¿¡ï¼‰", effects: { dance: 3, confidence: -2 }, next: "safeEnd", log: "ä½ æ²¡æœ‰å¥½å¥½çæƒœè¿™ä¸€æ”¯ç»ƒä¹ æœºä¼šã€‚"}
      ]
    },

    safeEnd: {
      areaKey: "dancefloor",
      title: "åˆå­¦è€…çš„ç¬¬ä¸€æ”¯å®Œæ•´æŠ±æŠ±èˆ",
      text: `éŸ³ä¹ç»“æŸï¼Œå¥¹é€€ååŠæ­¥ï¼Œå¯¹ä½ ç‚¹ç‚¹å¤´ï¼š

â€œä¸é”™å•¦ï¼Œç¬¬ä¸€æ¬¡èƒ½è¿™æ ·å·²ç»å¾ˆå¥½äº†ã€‚â€

ä½ å‘ç°ï¼Œä¸é æš§æ˜§ï¼Œä¸é ç”œè¨€èœœè¯­ï¼Œåªæ˜¯ä¸“å¿ƒè·³å¥½ä¸€æ”¯æŠ±æŠ±èˆï¼Œä¹Ÿæ˜¯å¾ˆçº¯ç²¹çš„å¿«ä¹ã€‚`,
      options: [
        { text: "è§å¥½å°±æ”¶ï¼Œå›èˆæ± è¾¹ç»§ç»­å½“è§‚å¯Ÿå‘˜", effects: { awareness: 5, antiPua: 6 }, next: "map_dancefloor", log: "ä½ å†³å®šæŠŠç¬¬ä¸€æ¬¡çš„å¥½ä½“éªŒï¼Œå®Œæ•´ä¿å­˜åœ¨è®°å¿†é‡Œã€‚"},
        { text: "å»å¸çƒŸåŒºï¼Œæ¶ˆåŒ–ä¸€ä¸‹åˆšåˆšçš„ä½“ä¼š", next: "map_smoking", log: "ä½ æƒ³æŠŠè¿™ä»½ä½“éªŒå’Œè€èˆå®¢çš„æ•…äº‹æ”¾åœ¨ä¸€èµ·æƒ³æƒ³ã€‚"}
      ]
    },

    // ===== ç»“å±€ä»¬ï¼ˆä»å¯è¯»æ¡£é‡å¼€ï¼‰ =====

    end_goHome: {
      areaKey: "entrance",
      title: "ç»“å±€ Â· å®¿èˆçš„ç¯å…‰",
      text: `ä½ æ²¡æœ‰èµ°è¿›åä¸œç ‚ç ‚èˆå…ã€‚

è€è¡—çš„éœ“è™¹åœ¨èº«åæ™ƒåŠ¨ï¼Œå®¿èˆæ¥¼ä¸‹çš„è·¯ç¯æŠŠä½ çš„å½±å­æ‹‰å¾—å¾ˆé•¿ã€‚

ä½ å°‘äº†ä¸€æ¬¡è¢«å¥—è·¯çš„é£é™©ï¼Œä¹Ÿé”™è¿‡äº†ä¸€æ¬¡å­¦ä¼šæŠ±æŠ±èˆçš„æœºä¼šã€‚`,
      end: true,
      options: [
        { text: "å†æ¥ä¸€æ™šï¼Œä»å¤´é€‰ä¸ªèº«ä»½", restart: true }
      ]
    },

    end_oneSongSafe: {
      areaKey: "dancefloor",
      title: "ç»“å±€ Â· ä¸€é¦–å°±å¥½",
      text: `ä½ åªè·³äº†ä¸€é¦–ï¼Œç¤¼è²Œé“åˆ«ï¼Œæ²¡æœ‰åå°ï¼Œä¹Ÿæ²¡æœ‰åŠ å¾®ä¿¡ã€‚

é’±åŒ…å—æŸæœ‰é™ï¼Œå¿ƒæ€å°šç®—å¹³ç¨³ã€‚

ä½ æˆåŠŸå®ˆä½äº†ç¬¬ä¸€æ¡åº•çº¿ã€‚`,
      end: true,
      options: [
        { text: "å¸¦ç€è¿™æ¡åº•çº¿ï¼Œé‡æ–°è¿›å…¥èˆå…", restart: true }
      ]
    },

    end_puaWallet: {
      areaKey: "dancefloor",
      title: "åç»“å±€ Â· é’±åŒ…æ›¿ä½ è°ˆäº†ä¸€åœºæ‹çˆ±",
      text: `ä½ ä¸€é¦–æ¥ä¸€é¦–åœ°è·³ï¼Œå¥¹ä¸€ä¼šè¯´å†·ï¼Œä¸€ä¼šè¯´ç´¯ï¼Œä¸€ä¼šåˆè¯´â€œä»Šæ™šå¥½æƒ¨â€ã€‚

ä½ åœ¨å¥¹å¿½å†·å¿½çƒ­çš„æ€åº¦é‡Œï¼Œä¸€æ¬¡æ¬¡æå‡ºé’±åŒ…ã€‚

å›è¿‡ç¥æ—¶ï¼Œè´¦å•æ¯”ä½ æƒ³è±¡çš„é•¿å¾—å¤šâ€”â€”ä½ çªç„¶æ˜ç™½äº†é‚£å¥è¯ï¼š

â€œä½ ä»¥ä¸ºåœ¨è°ˆæ‹çˆ±ï¼Œå¥¹åªæ˜¯ç®—æµæ°´ã€‚â€`,
      warning: "ã€ç»“æœè¯„ä¼°ï¼šå…¸å‹æƒ…æ„Ÿ + ç»æµ PUAã€‘\nä½ ä¸æ˜¯å¥¹çš„å”¯ä¸€ï¼Œåªæ˜¯å¥¹çš„å…¶ä¸­ä¸€ä¸ªå®¢äººã€‚",
      end: true,
      options: [
        { text: "å¸¦ç€æ•™è®­ï¼Œé‡æ–°è¿›åœº", restart: true }
      ]
    },

    end_controlBudget: {
      areaKey: "dancefloor",
      title: "GOOD END Â· é¢„ç®—å®ˆé—¨å‘˜",
      text: `ä½ ç¬‘ç€è¯´ï¼šâ€œæˆ‘é¢„ç®—æœ‰é™ï¼Œåªè·³è¿™ä¸€é¦–ï¼Œä¸‹æ¬¡å†è¯´ã€‚â€

å¥¹çš„ç¬‘å®¹æ·¡äº†ä¸€ç‚¹ï¼Œä½†ä¹Ÿæ²¡å†å¤šè¯´ä»€ä¹ˆï¼Œåªæ˜¯æŠŠè¿™ä¸€é¦–è®¤çœŸè·³å®Œã€‚

ä½ å‘ç°ï¼šå­¦ä¼šè¯´â€œä¸â€ï¼Œä¹Ÿæ˜¯èˆæ± é‡Œçš„é‡è¦ä¸€æ­¥ã€‚`,
      end: true,
      options: [
        { text: "å¸¦ç€è¿™ä»½æ¸…é†’ï¼Œå†ç©ä¸€å±€", restart: true }
      ]
    },

    end_coolPlayer: {
      areaKey: "dancefloor",
      title: "TRUE END çº¿ç´¢ Â· å†·é™çš„èˆå®¢",
      text: `ä½ å¾ˆæ¸…æ¥šåœ°è¯´å‡ºè‡ªå·±çš„åº•çº¿ï¼š

â€œæˆ‘å°±æƒ³ç»ƒæŠ±æŠ±èˆï¼Œä¸åå°ï¼Œä¸åŠ å¾®ä¿¡ï¼Œä¸ææƒ…æ„Ÿè´¦ã€‚â€

å¥¹æœ‰ä¸€ç¬é—´çš„é”™æ„•ï¼Œéšå³æŠŠæ³¨æ„åŠ›å®Œå…¨æ”¾å›èŠ‚å¥å’Œæ­¥å­ä¸Šã€‚

çœŸæ­£å‰å®³çš„èˆå®¢ï¼Œä»æ¥ä¸æ˜¯èŠ±å¾—æœ€å¤šçš„é‚£ä¸ªï¼Œè€Œæ˜¯æœ€æ¸…é†’çš„é‚£ä¸ªã€‚`,
      end: true,
      options: [
        { text: "æˆ‘æƒ³è§£é”æ›´å¤šâ€œæ¸…é†’èˆå®¢â€çš„è·¯çº¿", restart: true }
      ]
    }
  };

  // ===== å·¥å…·å‡½æ•° =====
  function clamp(val, min, max) {
    return Math.max(min, Math.min(max, val));
  }

  function formatText(text) {
    if (!text) return "";
    const role = gameState.roleId ? roles[gameState.roleId] : null;
    let t = text;
    if (role) {
      t = t.replace(/\{roleName\}/g, role.name)
           .replace(/\{roleAlias\}/g, role.alias || role.name);
    }
    return t;
  }

  function applyEffects(effects) {
    if (!effects) return;
    if (typeof effects.cash === "number") {
      gameState.cash += effects.cash;
      if (gameState.cash < 0) gameState.cash = 0;
    }
    if (typeof effects.stamina === "number") {
      gameState.stamina = clamp(gameState.stamina + effects.stamina, 0, 100);
    }
    if (typeof effects.confidence === "number") {
      gameState.confidence = clamp(gameState.confidence + effects.confidence, 0, 100);
    }
    if (typeof effects.dance === "number") {
      gameState.dance = clamp(gameState.dance + effects.dance, 0, 100);
    }
    if (typeof effects.awareness === "number") {
      gameState.awareness = clamp(gameState.awareness + effects.awareness, 0, 100);
    }
    if (typeof effects.antiPua === "number") {
      gameState.antiPua = clamp(gameState.antiPua + effects.antiPua, 0, 100);
    }
    updateStats();
  }

  function updateStats() {
    const cash = gameState.cash;
    const stamina = gameState.stamina;
    const confidence = gameState.confidence;
    const dance = gameState.dance;
    const awareness = gameState.awareness;
    const antiPua = gameState.antiPua;

    document.getElementById("statCash").textContent = cash;
    document.getElementById("statStamina").textContent = stamina;
    document.getElementById("statConfidence").textContent = confidence;
    document.getElementById("statDance").textContent = dance;
    document.getElementById("statAwareness").textContent = awareness;
    document.getElementById("statAntiPua").textContent = antiPua;

    document.getElementById("barCash").style.background =
      "linear-gradient(90deg,#7bed9f,#2ecc71)";
    document.getElementById("barStamina").style.background =
      "linear-gradient(90deg,#ff6b81,#ff4757)";
    document.getElementById("barConfidence").style.background =
      "linear-gradient(90deg,#feca57,#ff9f43)";
    document.getElementById("barDance").style.background =
      "linear-gradient(90deg,#70a1ff,#3742fa)";
    document.getElementById("barAwareness").style.background =
      "linear-gradient(90deg,#a29bfe,#6c5ce7)";
    document.getElementById("barAntiPua").style.background =
      "linear-gradient(90deg,#d1d8e0,#57606f)";

    document.getElementById("barCash").style.width =
      clamp((cash / MAX_CASH_BAR) * 100, 0, 100) + "%";
    document.getElementById("barStamina").style.width = stamina + "%";
    document.getElementById("barConfidence").style.width = confidence + "%";
    document.getElementById("barDance").style.width = dance + "%";
    document.getElementById("barAwareness").style.width = awareness + "%";
    document.getElementById("barAntiPua").style.width = antiPua + "%";
  }

  function addLogLine(text) {
    const box = document.getElementById("logBox");
    const line = document.createElement("div");
    line.className = "log-line";
    line.textContent = "Â· " + text;
    box.appendChild(line);
    box.scrollTop = box.scrollHeight;
  }

  function updateRoleCard() {
    const body = document.getElementById("roleCardBody");
    const traitsBox = document.getElementById("roleTraits");
    const avatarLabel = document.getElementById("avatarLabel");
    const avatarBodyEmoji = document.getElementById("avatarBodyEmoji");
    const avatar = document.getElementById("avatarPlayer");

    if (!gameState.roleId || !roles[gameState.roleId]) {
      body.innerHTML = "<em>å…ˆé€‰æ‹©ä¸€ä¸ªè§’è‰²ï¼Œå†³å®šä»Šæ™šä»¥è°çš„èº«ä»½åœ¨åä¸œç ‚ç ‚èˆå…è‡ªç”±æ¸¸èµ°ã€‚</em>";
      traitsBox.innerHTML = "";
      avatarLabel.textContent = "æœªé€‰æ‹©";
      avatarBodyEmoji.textContent = "ğŸ•º";
      avatar.style.background = "linear-gradient(180deg, #ffd1a9, #ff7f7f)";
      return;
    }

    const role = roles[gameState.roleId];
    body.innerHTML =
      `<strong>èº«ä»½ï¼š</strong>${role.name}<br>` +
      `<strong>èƒŒæ™¯ï¼š</strong>${role.desc}<br>` +
      `<strong>ä»Šæ—¥è£…å¤‡ï¼š</strong>${role.equip}`;

    traitsBox.innerHTML = "";
    (role.traits || []).forEach(tr => {
      const span = document.createElement("span");
      span.className = "badge";
      span.textContent = "ç‰¹è´¨ï¼š" + tr;
      traitsBox.appendChild(span);
    });

    avatarLabel.textContent = role.alias || role.name;
    avatarBodyEmoji.textContent = role.emoji || "ğŸ•º";
    avatar.style.background = `linear-gradient(180deg, ${role.color || "#ffd1a9"}, #3b1f4a)`;
  }

  function updateAvatarPartner() {
    const label = document.getElementById("avatarPartnerLabel");
    const emoji = document.getElementById("avatarPartnerEmoji");
    const avatar = document.getElementById("avatarPartner");

    if (gameState.sceneId === "sweetGirl" || gameState.sceneId === "sweetGirlTalk") {
      label.textContent = "ç”œå¿ƒèˆå¥³";
      emoji.textContent = "ğŸ’‹";
      avatar.style.background = "linear-gradient(180deg,#ff9ff3,#ff4b8b)";
    } else if (gameState.sceneId === "safeGirl" || gameState.sceneId === "safeEnd") {
      label.textContent = "æ™®é€šèˆå¥³";
      emoji.textContent = "ğŸ’ƒ";
      avatar.style.background = "linear-gradient(180deg,#ffcccc,#ff6b81)";
    } else {
      label.textContent = "èˆä¼´";
      emoji.textContent = "ğŸ’ƒ";
      avatar.style.background = "linear-gradient(180deg,#ff99d6,#ff4b8b)";
    }
  }

  function updateStageTheme(areaKey) {
    gameState.areaKey = areaKey || gameState.areaKey || "entrance";
    const theme = areaThemes[gameState.areaKey] || areaThemes["entrance"];
    const stage = document.getElementById("stage");
    const label = document.getElementById("stageAreaLabel");
    stage.style.background = theme.bg;
    label.textContent = "åŒºåŸŸï¼š" + theme.label;
  }

  function chooseRole(roleId) {
    const role = roles[roleId];
    if (!role) return;
    gameState.roleId = roleId;
    gameState.cash = role.stats.cash;
    gameState.stamina = role.stats.stamina;
    gameState.confidence = role.stats.confidence;
    gameState.dance = role.stats.dance;
    gameState.awareness = role.stats.awareness;
    gameState.antiPua = role.stats.antiPua;
    gameState.flags = {};
    gameState.enteredScenes = {};
    updateStats();
    updateRoleCard();
  }

  function renderScene() {
    const scene = scenes[gameState.sceneId];
    if (!scene) return;

    // onEnter åªåœ¨é¦–æ¬¡è¿›å…¥æ—¶è§¦å‘
    if (scene.onEnter && !gameState.enteredScenes[gameState.sceneId]) {
      scene.onEnter(gameState);
      gameState.enteredScenes[gameState.sceneId] = true;
      updateStats();
    }

    if (scene.areaKey) {
      updateStageTheme(scene.areaKey);
    }

    document.getElementById("sceneTitle").textContent = scene.title || "";
    document.getElementById("sceneText").textContent = formatText(scene.text);

    const warnEl = document.getElementById("sceneWarning");
    if (scene.warning) {
      warnEl.style.display = "block";
      warnEl.textContent = scene.warning;
    } else {
      warnEl.style.display = "none";
      warnEl.textContent = "";
    }

    const choicesBox = document.getElementById("choices");
    choicesBox.innerHTML = "";

    (scene.options || []).forEach((opt, index) => {
      const btn = document.createElement("button");
      btn.className = "choice" + (opt.secondary ? " secondary" : "");
      btn.textContent = (index + 1) + ". " + opt.text;
      btn.onclick = () => {
        playClick();
        if (opt.log) addLogLine(opt.log);
        if (opt.chooseRole) chooseRole(opt.chooseRole);
        if (opt.effects) applyEffects(opt.effects);
        if (opt.restart) {
          restartGame();
          return;
        }
        if (opt.next) {
          gameState.sceneId = opt.next;
          renderScene();
        }
      };
      choicesBox.appendChild(btn);
    });

    updateAvatarPartner();
  }

  // åŒºåŸŸç§»åŠ¨ï¼ˆæ²™ç›’æ„Ÿï¼‰
  function moveArea(direction) {
    playClick();
    const s = gameState.sceneId;
    const scene = scenes[s];
    // å¦‚æœåœ¨è§’è‰²é€‰æ‹© / ç»“å±€ï¼Œä¸å“åº”åœ°å›¾ç§»åŠ¨
    if (!scene || scene.end || s === "roleSelect") {
      return;
    }
    // ä¸­å¿ƒç”¨ map_* ä¸ºâ€œåœ°å›¾å§¿æ€â€åœºæ™¯
    const area = scene.areaKey || gameState.areaKey;

    if (direction === "info") {
      alert("èˆå…ç®€æ˜“åœ°å›¾ï¼š\n\nå‰å°å¤§å…ï¼šè¿æ¥èˆæ± ã€å§å°ã€å¡åº§ã€å¸çƒŸåŒºã€‚\nèˆæ± ï¼šæŠ±æŠ±èˆä¸»æˆ˜åœºï¼Œå¯ç›´æ¥è§‚å¯Ÿæˆ–ç‚¹èˆã€‚\nèˆå¥³é˜Ÿåˆ—ï¼šç¯å…‰æœ€äº®ï¼ŒæŒ‘äººä¹Ÿæœ€å®¹æ˜“è¢«æŒ‘ã€‚\nå§å°ï¼šä¸è·³èˆï¼Œä½†å…«å¦å’Œè¦ç¤¼ç‰©éƒ½å¤šã€‚\nå¡åº§ï¼šæœºè½¦èˆå¥³èšé›†åœ°ï¼Œæ³¨æ„é¿å‘ã€‚\nå¸çƒŸåŒºï¼šå¬æ•…äº‹ã€å¬æ•™è®­çš„åœ°æ–¹ã€‚\nèµ°å»Š/å•æ‰€å£ï¼šé¾™å¥³ã€è¡¥å¦†ã€çœŸè¯åœ°å¸¦ã€‚");
      return;
    }

    // ç®€å•çš„æ–¹ä½é€»è¾‘ï¼Œå°½é‡è‡ªç„¶å³å¯
    if (area === "lobby") {
      if (direction === "up") gameState.sceneId = "map_dancefloor";
      else if (direction === "left") gameState.sceneId = "map_bar";
      else if (direction === "right") gameState.sceneId = "map_seats";
      else if (direction === "down") gameState.sceneId = "map_smoking";
      else if (direction === "stay") gameState.sceneId = "map_lobby";
    } else if (area === "dancefloor") {
      if (direction === "down") gameState.sceneId = "map_lobby";
      else if (direction === "up") gameState.sceneId = "map_girlline";
      else if (direction === "stay") gameState.sceneId = "map_dancefloor";
    } else if (area === "girlline") {
      if (direction === "down") gameState.sceneId = "map_dancefloor";
      else if (direction === "stay") gameState.sceneId = "map_girlline";
    } else if (area === "bar") {
      if (direction === "right") gameState.sceneId = "map_seats";
      else if (direction === "up") gameState.sceneId = "map_lobby";
      else if (direction === "stay") gameState.sceneId = "map_bar";
    } else if (area === "seats") {
      if (direction === "left") gameState.sceneId = "map_bar";
      else if (direction === "up") gameState.sceneId = "map_lobby";
      else if (direction === "stay") gameState.sceneId = "map_seats";
    } else if (area === "smoking") {
      if (direction === "up") gameState.sceneId = "map_lobby";
      else if (direction === "right") gameState.sceneId = "map_corridor";
      else if (direction === "stay") gameState.sceneId = "map_smoking";
    } else if (area === "corridor") {
      if (direction === "left") gameState.sceneId = "map_smoking";
      else if (direction === "up") gameState.sceneId = "map_dancefloor";
      else if (direction === "stay") gameState.sceneId = "map_corridor";
    } else if (area === "entrance") {
      if (direction === "up") gameState.sceneId = "lobby_front";
      else if (direction === "stay") gameState.sceneId = "entrance_intro";
    }

    renderScene();
  }

  // ===== éŸ³ä¹ / éŸ³æ•ˆ =====
  let bgmOn = false;

  function toggleBgm(btn) {
    const audio = document.getElementById("bgm");
    if (!audio) return;
    if (!bgmOn) {
      audio.play().catch(() => {});
      bgmOn = true;
      if (btn) btn.textContent = "â¸ï¸ æš‚åœéŸ³ä¹";
    } else {
      audio.pause();
      bgmOn = false;
      if (btn) btn.textContent = "ğŸµ èƒŒæ™¯éŸ³ä¹";
    }
  }

  function playClick() {
    const a = document.getElementById("sfxClick");
    if (!a) return;
    try {
      a.currentTime = 0;
      a.play().catch(() => {});
    } catch (e) {}
  }

  // ===== å­˜æ¡£ / è¯»æ¡£ =====
  const SAVE_KEY = "huadong_salsa_sandbox_v1";

  function saveGame() {
    const data = {
      roleId: gameState.roleId,
      cash: gameState.cash,
      stamina: gameState.stamina,
      confidence: gameState.confidence,
      dance: gameState.dance,
      awareness: gameState.awareness,
      antiPua: gameState.antiPua,
      sceneId: gameState.sceneId,
      areaKey: gameState.areaKey,
      flags: gameState.flags,
      enteredScenes: gameState.enteredScenes
    };
    try {
      localStorage.setItem(SAVE_KEY, JSON.stringify(data));
      addLogLine("ğŸ’¾ è¿›åº¦å·²ä¿å­˜ã€‚");
    } catch (e) {
      addLogLine("âš ï¸ å­˜æ¡£å¤±è´¥ï¼ˆæµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒæˆ–ç©ºé—´ä¸è¶³ï¼‰ã€‚");
    }
  }

  function loadGame() {
    try {
      const raw = localStorage.getItem(SAVE_KEY);
      if (!raw) {
        addLogLine("âš ï¸ æ²¡æœ‰æ‰¾åˆ°å­˜æ¡£ã€‚");
        return;
      }
      const data = JSON.parse(raw);
      if (!data || !data.sceneId) {
        addLogLine("âš ï¸ å­˜æ¡£æ ¼å¼æ— æ•ˆã€‚");
        return;
      }
      gameState.roleId = data.roleId || null;
      gameState.cash = data.cash ?? 0;
      gameState.stamina = data.stamina ?? 0;
      gameState.confidence = data.confidence ?? 0;
      gameState.dance = data.dance ?? 0;
      gameState.awareness = data.awareness ?? 0;
      gameState.antiPua = data.antiPua ?? 0;
      gameState.sceneId = data.sceneId || "roleSelect";
      gameState.areaKey = data.areaKey || "entrance";
      gameState.flags = data.flags || {};
      gameState.enteredScenes = data.enteredScenes || {};

      updateStats();
      updateRoleCard();
      renderScene();
      addLogLine("ğŸ“‚ å·²è¯»å–å­˜æ¡£ï¼Œä½ å›åˆ°äº†ä¸Šæ¬¡ç¦»å¼€çš„é‚£ä¸€åˆ»ã€‚");
    } catch (e) {
      addLogLine("âš ï¸ è¯»æ¡£å¤±è´¥ã€‚");
    }
  }

  // ===== é‡å¼€ =====
  function restartGame() {
    gameState.roleId = null;
    gameState.cash = 0;
    gameState.stamina = 0;
    gameState.confidence = 0;
    gameState.dance = 0;
    gameState.awareness = 0;
    gameState.antiPua = 0;
    gameState.sceneId = "roleSelect";
    gameState.areaKey = "entrance";
    gameState.flags = {};
    gameState.enteredScenes = {};

    document.getElementById("logBox").innerHTML = "";
    addLogLine("æ–°çš„å¤œæ™šå¼€å§‹äº†ï¼Œä½ åˆç«™åœ¨åä¸œç ‚ç ‚èˆå…çš„é—¨å£ã€‚");
    updateStats();
    updateRoleCard();
    updateStageTheme("entrance");
    renderScene();
  }

  // ===== åˆå§‹åŒ– =====
  updateStats();
  updateRoleCard();
  updateStageTheme("entrance");
  addLogLine("ä½ æ¥åˆ°åä¸œç ‚ç ‚èˆå…çš„é—¨å£ï¼Œå‡†å¤‡é€‰æ‹©ä»Šæ™šçš„èº«ä»½ã€‚");
  renderScene();
</script>
</body>
</html>

